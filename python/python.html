<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="generator" content="AsciiDoc 8.6.9">
<title>A List of <span class="monospaced">python</span> Tips, Tricks and recipes/idioms</title>
<style type="text/css">
/* Shared CSS for AsciiDoc xhtml11 and html5 backends */

/* Default font. */
body {
  font-family: Georgia,serif;
}

/* Title font. */
h1, h2, h3, h4, h5, h6,
div.title, caption.title,
thead, p.table.header,
#toctitle,
#author, #revnumber, #revdate, #revremark,
#footer {
  font-family: Arial,Helvetica,sans-serif;
}

body {
  margin: 1em 5% 1em 5%;
}

a {
  color: blue;
  text-decoration: underline;
}
a:visited {
  color: fuchsia;
}

em {
  font-style: italic;
  color: navy;
}

strong {
  font-weight: bold;
  color: #083194;
}

h1, h2, h3, h4, h5, h6 {
  color: #527bbd;
  margin-top: 1.2em;
  margin-bottom: 0.5em;
  line-height: 1.3;
}

h1, h2, h3 {
  border-bottom: 2px solid silver;
}
h2 {
  padding-top: 0.5em;
}
h3 {
  float: left;
}
h3 + * {
  clear: left;
}
h5 {
  font-size: 1.0em;
}

div.sectionbody {
  margin-left: 0;
}

hr {
  border: 1px solid silver;
}

p {
  margin-top: 0.5em;
  margin-bottom: 0.5em;
}

ul, ol, li > p {
  margin-top: 0;
}
ul > li     { color: #aaa; }
ul > li > * { color: black; }

.monospaced, code, pre {
  font-family: "Courier New", Courier, monospace;
  font-size: inherit;
  color: navy;
  padding: 0;
  margin: 0;
}
pre {
  white-space: pre-wrap;
}

#author {
  color: #527bbd;
  font-weight: bold;
  font-size: 1.1em;
}
#email {
}
#revnumber, #revdate, #revremark {
}

#footer {
  font-size: small;
  border-top: 2px solid silver;
  padding-top: 0.5em;
  margin-top: 4.0em;
}
#footer-text {
  float: left;
  padding-bottom: 0.5em;
}
#footer-badges {
  float: right;
  padding-bottom: 0.5em;
}

#preamble {
  margin-top: 1.5em;
  margin-bottom: 1.5em;
}
div.imageblock, div.exampleblock, div.verseblock,
div.quoteblock, div.literalblock, div.listingblock, div.sidebarblock,
div.admonitionblock {
  margin-top: 1.0em;
  margin-bottom: 1.5em;
}
div.admonitionblock {
  margin-top: 2.0em;
  margin-bottom: 2.0em;
  margin-right: 10%;
  color: #606060;
}

div.content { /* Block element content. */
  padding: 0;
}

/* Block element titles. */
div.title, caption.title {
  color: #527bbd;
  font-weight: bold;
  text-align: left;
  margin-top: 1.0em;
  margin-bottom: 0.5em;
}
div.title + * {
  margin-top: 0;
}

td div.title:first-child {
  margin-top: 0.0em;
}
div.content div.title:first-child {
  margin-top: 0.0em;
}
div.content + div.title {
  margin-top: 0.0em;
}

div.sidebarblock > div.content {
  background: #ffffee;
  border: 1px solid #dddddd;
  border-left: 4px solid #f0f0f0;
  padding: 0.5em;
}

div.listingblock > div.content {
  border: 1px solid #dddddd;
  border-left: 5px solid #f0f0f0;
  background: #f8f8f8;
  padding: 0.5em;
}

div.quoteblock, div.verseblock {
  padding-left: 1.0em;
  margin-left: 1.0em;
  margin-right: 10%;
  border-left: 5px solid #f0f0f0;
  color: #888;
}

div.quoteblock > div.attribution {
  padding-top: 0.5em;
  text-align: right;
}

div.verseblock > pre.content {
  font-family: inherit;
  font-size: inherit;
}
div.verseblock > div.attribution {
  padding-top: 0.75em;
  text-align: left;
}
/* DEPRECATED: Pre version 8.2.7 verse style literal block. */
div.verseblock + div.attribution {
  text-align: left;
}

div.admonitionblock .icon {
  vertical-align: top;
  font-size: 1.1em;
  font-weight: bold;
  text-decoration: underline;
  color: #527bbd;
  padding-right: 0.5em;
}
div.admonitionblock td.content {
  padding-left: 0.5em;
  border-left: 3px solid #dddddd;
}

div.exampleblock > div.content {
  border-left: 3px solid #dddddd;
  padding-left: 0.5em;
}

div.imageblock div.content { padding-left: 0; }
span.image img { border-style: none; vertical-align: text-bottom; }
a.image:visited { color: white; }

dl {
  margin-top: 0.8em;
  margin-bottom: 0.8em;
}
dt {
  margin-top: 0.5em;
  margin-bottom: 0;
  font-style: normal;
  color: navy;
}
dd > *:first-child {
  margin-top: 0.1em;
}

ul, ol {
    list-style-position: outside;
}
ol.arabic {
  list-style-type: decimal;
}
ol.loweralpha {
  list-style-type: lower-alpha;
}
ol.upperalpha {
  list-style-type: upper-alpha;
}
ol.lowerroman {
  list-style-type: lower-roman;
}
ol.upperroman {
  list-style-type: upper-roman;
}

div.compact ul, div.compact ol,
div.compact p, div.compact p,
div.compact div, div.compact div {
  margin-top: 0.1em;
  margin-bottom: 0.1em;
}

tfoot {
  font-weight: bold;
}
td > div.verse {
  white-space: pre;
}

div.hdlist {
  margin-top: 0.8em;
  margin-bottom: 0.8em;
}
div.hdlist tr {
  padding-bottom: 15px;
}
dt.hdlist1.strong, td.hdlist1.strong {
  font-weight: bold;
}
td.hdlist1 {
  vertical-align: top;
  font-style: normal;
  padding-right: 0.8em;
  color: navy;
}
td.hdlist2 {
  vertical-align: top;
}
div.hdlist.compact tr {
  margin: 0;
  padding-bottom: 0;
}

.comment {
  background: yellow;
}

.footnote, .footnoteref {
  font-size: 0.8em;
}

span.footnote, span.footnoteref {
  vertical-align: super;
}

#footnotes {
  margin: 20px 0 20px 0;
  padding: 7px 0 0 0;
}

#footnotes div.footnote {
  margin: 0 0 5px 0;
}

#footnotes hr {
  border: none;
  border-top: 1px solid silver;
  height: 1px;
  text-align: left;
  margin-left: 0;
  width: 20%;
  min-width: 100px;
}

div.colist td {
  padding-right: 0.5em;
  padding-bottom: 0.3em;
  vertical-align: top;
}
div.colist td img {
  margin-top: 0.3em;
}

@media print {
  #footer-badges { display: none; }
}

#toc {
  margin-bottom: 2.5em;
}

#toctitle {
  color: #527bbd;
  font-size: 1.1em;
  font-weight: bold;
  margin-top: 1.0em;
  margin-bottom: 0.1em;
}

div.toclevel0, div.toclevel1, div.toclevel2, div.toclevel3, div.toclevel4 {
  margin-top: 0;
  margin-bottom: 0;
}
div.toclevel2 {
  margin-left: 2em;
  font-size: 0.9em;
}
div.toclevel3 {
  margin-left: 4em;
  font-size: 0.9em;
}
div.toclevel4 {
  margin-left: 6em;
  font-size: 0.9em;
}

span.aqua { color: aqua; }
span.black { color: black; }
span.blue { color: blue; }
span.fuchsia { color: fuchsia; }
span.gray { color: gray; }
span.green { color: green; }
span.lime { color: lime; }
span.maroon { color: maroon; }
span.navy { color: navy; }
span.olive { color: olive; }
span.purple { color: purple; }
span.red { color: red; }
span.silver { color: silver; }
span.teal { color: teal; }
span.white { color: white; }
span.yellow { color: yellow; }

span.aqua-background { background: aqua; }
span.black-background { background: black; }
span.blue-background { background: blue; }
span.fuchsia-background { background: fuchsia; }
span.gray-background { background: gray; }
span.green-background { background: green; }
span.lime-background { background: lime; }
span.maroon-background { background: maroon; }
span.navy-background { background: navy; }
span.olive-background { background: olive; }
span.purple-background { background: purple; }
span.red-background { background: red; }
span.silver-background { background: silver; }
span.teal-background { background: teal; }
span.white-background { background: white; }
span.yellow-background { background: yellow; }

span.big { font-size: 2em; }
span.small { font-size: 0.6em; }

span.underline { text-decoration: underline; }
span.overline { text-decoration: overline; }
span.line-through { text-decoration: line-through; }

div.unbreakable { page-break-inside: avoid; }


/*
 * xhtml11 specific
 *
 * */

div.tableblock {
  margin-top: 1.0em;
  margin-bottom: 1.5em;
}
div.tableblock > table {
  border: 3px solid #527bbd;
}
thead, p.table.header {
  font-weight: bold;
  color: #527bbd;
}
p.table {
  margin-top: 0;
}
/* Because the table frame attribute is overriden by CSS in most browsers. */
div.tableblock > table[frame="void"] {
  border-style: none;
}
div.tableblock > table[frame="hsides"] {
  border-left-style: none;
  border-right-style: none;
}
div.tableblock > table[frame="vsides"] {
  border-top-style: none;
  border-bottom-style: none;
}


/*
 * html5 specific
 *
 * */

table.tableblock {
  margin-top: 1.0em;
  margin-bottom: 1.5em;
}
thead, p.tableblock.header {
  font-weight: bold;
  color: #527bbd;
}
p.tableblock {
  margin-top: 0;
}
table.tableblock {
  border-width: 3px;
  border-spacing: 0px;
  border-style: solid;
  border-color: #527bbd;
  border-collapse: collapse;
}
th.tableblock, td.tableblock {
  border-width: 1px;
  padding: 4px;
  border-style: solid;
  border-color: #527bbd;
}

table.tableblock.frame-topbot {
  border-left-style: hidden;
  border-right-style: hidden;
}
table.tableblock.frame-sides {
  border-top-style: hidden;
  border-bottom-style: hidden;
}
table.tableblock.frame-none {
  border-style: hidden;
}

th.tableblock.halign-left, td.tableblock.halign-left {
  text-align: left;
}
th.tableblock.halign-center, td.tableblock.halign-center {
  text-align: center;
}
th.tableblock.halign-right, td.tableblock.halign-right {
  text-align: right;
}

th.tableblock.valign-top, td.tableblock.valign-top {
  vertical-align: top;
}
th.tableblock.valign-middle, td.tableblock.valign-middle {
  vertical-align: middle;
}
th.tableblock.valign-bottom, td.tableblock.valign-bottom {
  vertical-align: bottom;
}


/*
 * manpage specific
 *
 * */

body.manpage h1 {
  padding-top: 0.5em;
  padding-bottom: 0.5em;
  border-top: 2px solid silver;
  border-bottom: 2px solid silver;
}
body.manpage h2 {
  border-style: none;
}
body.manpage div.sectionbody {
  margin-left: 3em;
}

@media print {
  body.manpage div#toc { display: none; }
}


</style>
<script type="text/javascript">
/*<![CDATA[*/
var asciidoc = {  // Namespace.

/////////////////////////////////////////////////////////////////////
// Table Of Contents generator
/////////////////////////////////////////////////////////////////////

/* Author: Mihai Bazon, September 2002
 * http://students.infoiasi.ro/~mishoo
 *
 * Table Of Content generator
 * Version: 0.4
 *
 * Feel free to use this script under the terms of the GNU General Public
 * License, as long as you do not remove or alter this notice.
 */

 /* modified by Troy D. Hanson, September 2006. License: GPL */
 /* modified by Stuart Rackham, 2006, 2009. License: GPL */

// toclevels = 1..4.
toc: function (toclevels) {

  function getText(el) {
    var text = "";
    for (var i = el.firstChild; i != null; i = i.nextSibling) {
      if (i.nodeType == 3 /* Node.TEXT_NODE */) // IE doesn't speak constants.
        text += i.data;
      else if (i.firstChild != null)
        text += getText(i);
    }
    return text;
  }

  function TocEntry(el, text, toclevel) {
    this.element = el;
    this.text = text;
    this.toclevel = toclevel;
  }

  function tocEntries(el, toclevels) {
    var result = new Array;
    var re = new RegExp('[hH]([1-'+(toclevels+1)+'])');
    // Function that scans the DOM tree for header elements (the DOM2
    // nodeIterator API would be a better technique but not supported by all
    // browsers).
    var iterate = function (el) {
      for (var i = el.firstChild; i != null; i = i.nextSibling) {
        if (i.nodeType == 1 /* Node.ELEMENT_NODE */) {
          var mo = re.exec(i.tagName);
          if (mo && (i.getAttribute("class") || i.getAttribute("className")) != "float") {
            result[result.length] = new TocEntry(i, getText(i), mo[1]-1);
          }
          iterate(i);
        }
      }
    }
    iterate(el);
    return result;
  }

  var toc = document.getElementById("toc");
  if (!toc) {
    return;
  }

  // Delete existing TOC entries in case we're reloading the TOC.
  var tocEntriesToRemove = [];
  var i;
  for (i = 0; i < toc.childNodes.length; i++) {
    var entry = toc.childNodes[i];
    if (entry.nodeName.toLowerCase() == 'div'
     && entry.getAttribute("class")
     && entry.getAttribute("class").match(/^toclevel/))
      tocEntriesToRemove.push(entry);
  }
  for (i = 0; i < tocEntriesToRemove.length; i++) {
    toc.removeChild(tocEntriesToRemove[i]);
  }

  // Rebuild TOC entries.
  var entries = tocEntries(document.getElementById("content"), toclevels);
  for (var i = 0; i < entries.length; ++i) {
    var entry = entries[i];
    if (entry.element.id == "")
      entry.element.id = "_toc_" + i;
    var a = document.createElement("a");
    a.href = "#" + entry.element.id;
    a.appendChild(document.createTextNode(entry.text));
    var div = document.createElement("div");
    div.appendChild(a);
    div.className = "toclevel" + entry.toclevel;
    toc.appendChild(div);
  }
  if (entries.length == 0)
    toc.parentNode.removeChild(toc);
},


/////////////////////////////////////////////////////////////////////
// Footnotes generator
/////////////////////////////////////////////////////////////////////

/* Based on footnote generation code from:
 * http://www.brandspankingnew.net/archive/2005/07/format_footnote.html
 */

footnotes: function () {
  // Delete existing footnote entries in case we're reloading the footnodes.
  var i;
  var noteholder = document.getElementById("footnotes");
  if (!noteholder) {
    return;
  }
  var entriesToRemove = [];
  for (i = 0; i < noteholder.childNodes.length; i++) {
    var entry = noteholder.childNodes[i];
    if (entry.nodeName.toLowerCase() == 'div' && entry.getAttribute("class") == "footnote")
      entriesToRemove.push(entry);
  }
  for (i = 0; i < entriesToRemove.length; i++) {
    noteholder.removeChild(entriesToRemove[i]);
  }

  // Rebuild footnote entries.
  var cont = document.getElementById("content");
  var spans = cont.getElementsByTagName("span");
  var refs = {};
  var n = 0;
  for (i=0; i<spans.length; i++) {
    if (spans[i].className == "footnote") {
      n++;
      var note = spans[i].getAttribute("data-note");
      if (!note) {
        // Use [\s\S] in place of . so multi-line matches work.
        // Because JavaScript has no s (dotall) regex flag.
        note = spans[i].innerHTML.match(/\s*\[([\s\S]*)]\s*/)[1];
        spans[i].innerHTML =
          "[<a id='_footnoteref_" + n + "' href='#_footnote_" + n +
          "' title='View footnote' class='footnote'>" + n + "</a>]";
        spans[i].setAttribute("data-note", note);
      }
      noteholder.innerHTML +=
        "<div class='footnote' id='_footnote_" + n + "'>" +
        "<a href='#_footnoteref_" + n + "' title='Return to text'>" +
        n + "</a>. " + note + "</div>";
      var id =spans[i].getAttribute("id");
      if (id != null) refs["#"+id] = n;
    }
  }
  if (n == 0)
    noteholder.parentNode.removeChild(noteholder);
  else {
    // Process footnoterefs.
    for (i=0; i<spans.length; i++) {
      if (spans[i].className == "footnoteref") {
        var href = spans[i].getElementsByTagName("a")[0].getAttribute("href");
        href = href.match(/#.*/)[0];  // Because IE return full URL.
        n = refs[href];
        spans[i].innerHTML =
          "[<a href='#_footnote_" + n +
          "' title='View footnote' class='footnote'>" + n + "</a>]";
      }
    }
  }
},

install: function(toclevels) {
  var timerId;

  function reinstall() {
    asciidoc.footnotes();
    if (toclevels) {
      asciidoc.toc(toclevels);
    }
  }

  function reinstallAndRemoveTimer() {
    clearInterval(timerId);
    reinstall();
  }

  timerId = setInterval(reinstall, 500);
  if (document.addEventListener)
    document.addEventListener("DOMContentLoaded", reinstallAndRemoveTimer, false);
  else
    window.onload = reinstallAndRemoveTimer;
}

}
asciidoc.install(2);
/*]]>*/
</script>
</head>
<body class="article">
<div id="header">
<h1>A List of <span class="monospaced">python</span> Tips, Tricks and recipes/idioms</h1>
<span id="author">Christoph Hoffmann</span><br>
<span id="email" class="monospaced">&lt;<a href="mailto:choffmann1983@gmail.com">choffmann1983@gmail.com</a>&gt;</span><br>
<span id="revnumber">version 0.0.1 'http://semver.org/[(semver)]'</span>
<div id="toc">
  <div id="toctitle">Table of Contents</div>
  <noscript><p><b>JavaScript must be enabled in your browser to display the table of contents.</b></p></noscript>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="_introduction">1. Introduction</h2>
<div class="sectionbody">
<div class="paragraph"><p>todo &#8230;</p></div>
<div class="paragraph"><p>Here is a list of interesting links:</p></div>
<div class="ulist"><ul>
<li>
<p>
<a href="http://ivory.idyll.org/articles/advanced-swc/">Intermediate and Advanced Software Carpentry in Python</a>
</p>
</li>
<li>
<p>
<a href="http://python.net/~goodger/projects/pycon/2007/idiomatic/handout.html">Code Like a Pythonista: Idiomatic Python</a>
</p>
</li>
<li>
<p>
<a href="http://code.activestate.com/recipes/langs/python/">Popular Python recipes </a>
</p>
</li>
</ul></div>
</div>
</div>
<div class="sect1">
<h2 id="_shebang">2. Shebang</h2>
<div class="sectionbody">
<div class="admonitionblock">
<table><tr>
<td class="icon">
<img src="../asciidoc/images/icons/tip.png" alt="Tip">
</td>
<td class="content">
<div class="paragraph"><p>Detailed description at source: <a href="https://en.wikipedia.org/wiki/Shebang_(Unix)">wikipedia.org</a></p></div>
</td>
</tr></table>
</div>
<div class="paragraph"><p>Shebang is used to let the operation system know how to interpret the given script. Shebangs have to be place on the first line of code.</p></div>
<div class="listingblock">
<div class="content">
<pre><code><span style="color:#838183; font-style:italic">#!/usr/bin/env python</span></code></pre>
</div></div>
</div>
</div>
<div class="sect1">
<h2 id="_docstrings">3. Docstrings</h2>
<div class="sectionbody">
<div class="admonitionblock">
<table><tr>
<td class="icon">
<img src="../asciidoc/images/icons/tip.png" alt="Tip">
</td>
<td class="content">
<div class="ulist"><ul>
<li>
<p>
<a href="https://en.wikipedia.org/wiki/Docstring#Python">python wiki</a>
</p>
</li>
<li>
<p>
<a href="http://tovid.wikia.com/wiki/Python_tips/Docstrings">Docstring</a>
</p>
</li>
<li>
<p>
<a href="http://www.onlamp.com/lpt/a/python/2001/05/17/docstrings.html">tips and tricks</a>
</p>
</li>
</ul></div>
</td>
</tr></table>
</div>
<div class="sect2">
<h3 id="_docstring_convention">3.1. Docstring convention</h3>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<img src="../asciidoc/images/icons/tip.png" alt="Tip">
</td>
<td class="content">
<div class="ulist"><ul>
<li>
<p>
<a href="http://www.python.org/dev/peps/pep-0257/">convention</a>
</p>
</li>
<li>
<p>
<a href="https://code.google.com/p/google-styleguide/">google-styleguide</a>
</p>
</li>
<li>
<p>
<a href="http://google-styleguide.googlecode.com/svn/trunk/pyguide.html">pyguide</a>
</p>
</li>
</ul></div>
</td>
</tr></table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_enum_in_python">4. Enum in python</h2>
<div class="sectionbody">
<div class="paragraph"><p>In python exists no Enum type. So, it has to be created manually. This example demonstrates a way of creating Enums with dictionaries.</p></div>
<div class="listingblock">
<div class="title">Workaround to create Enums in python</div>
<div class="content">
<pre><code><span style="color:#000000; font-weight:bold">def</span> <span style="color:#010181">enum</span><span style="color:#000000">(*</span>sequential<span style="color:#000000">, **</span>named<span style="color:#000000">):</span>
    <span style="color:#bf0303">'''</span>
<span style="color:#bf0303">    Example:  num = enum(ONE=1, TWO=2, THREE='three')</span>
<span style="color:#bf0303">              num.ONE &gt;&gt;&gt; 1</span>
<span style="color:#bf0303">    Support for converting the values back to names can be added this way:</span>
<span style="color:#bf0303">              num.reverse_mapping[2] &gt;&gt; 'TWO'</span>
<span style="color:#bf0303">    Source: http://stackoverflow.com/a/1695250</span>
<span style="color:#bf0303">    '''</span>
    enums <span style="color:#000000">=</span> <span style="color:#0057ae">dict</span><span style="color:#000000">(</span><span style="color:#0057ae">zip</span><span style="color:#000000">(</span>sequential<span style="color:#000000">,</span> <span style="color:#0057ae">range</span><span style="color:#000000">(</span><span style="color:#0057ae">len</span><span style="color:#000000">(</span>sequential<span style="color:#000000">))), **</span>named<span style="color:#000000">)</span>
    reverse <span style="color:#000000">=</span> <span style="color:#0057ae">dict</span><span style="color:#000000">((</span>value<span style="color:#000000">,</span> key<span style="color:#000000">)</span> <span style="color:#000000; font-weight:bold">for</span> key<span style="color:#000000">,</span> value <span style="color:#000000; font-weight:bold">in</span> enums<span style="color:#000000">.</span><span style="color:#010181">iteritems</span><span style="color:#000000">())</span>
    enums<span style="color:#000000">[</span><span style="color:#bf0303">'reverse_mapping'</span><span style="color:#000000">] =</span> reverse
    <span style="color:#000000; font-weight:bold">return</span> <span style="color:#0057ae">type</span><span style="color:#000000">(</span><span style="color:#bf0303">'Enum'</span><span style="color:#000000">, (),</span> enums<span style="color:#000000">)</span></code></pre>
</div></div>
</div>
</div>
<div class="sect1">
<h2 id="_python_imaging_library_a_href_http_www_pythonware_com_products_pil_pil_a">5. Python Imaging Library (<a href="http://www.pythonware.com/products/pil/">PIL</a>)</h2>
<div class="sectionbody">
<div class="paragraph"><p>PIL is a good library to handle images in python.</p></div>
<div class="paragraph"><p>Installing the PIL on Ubuntu 64 bit revealed some issues.</p></div>
<div class="quoteblock">
<div class="content">It turns out that the APT installations put the libraries under <em>/usr/lib/x86_64-linux-gnu</em> and PIL will search for them in <em>/usr/lib/</em>. So you have to create symlinks for PIL to see them.</div>
<div class="attribution">
&#8212; anonymous
</div></div>
<div class="listingblock">
<div class="content">
<pre><code><span style="color:#000000; font-weight:bold">ln</span> <span style="color:#000000">-</span>s <span style="color:#000000">/</span>usr<span style="color:#000000">/</span>lib<span style="color:#000000">/</span>x86_64-linux-gnu<span style="color:#000000">/</span>libjpeg.so <span style="color:#000000">/</span>usr<span style="color:#000000">/</span>lib
<span style="color:#000000; font-weight:bold">ln</span> <span style="color:#000000">-</span>s <span style="color:#000000">/</span>usr<span style="color:#000000">/</span>lib<span style="color:#000000">/</span>x86_64-linux-gnu<span style="color:#000000">/</span>libfreetype.so <span style="color:#000000">/</span>usr<span style="color:#000000">/</span>lib
<span style="color:#000000; font-weight:bold">ln</span> <span style="color:#000000">-</span>s <span style="color:#000000">/</span>usr<span style="color:#000000">/</span>lib<span style="color:#000000">/</span>x86_64-linux-gnu<span style="color:#000000">/</span>libz.so <span style="color:#000000">/</span>usr<span style="color:#000000">/</span>lib</code></pre>
</div></div>
<div class="paragraph"><p>Source: <a href="http://jj.isgeek.net/2011/09/install-pil-with-jpeg-support-on-ubuntu-oneiric-64bits/">http://jj.isgeek.net/2011/09/install-pil-with-jpeg-support-on-ubuntu-oneiric-64bits/</a></p></div>
</div>
</div>
<div class="sect1">
<h2 id="_importing_libs_in_main_only">6. Importing libs in main only</h2>
<div class="sectionbody">
<div class="paragraph"><p>Sometimes libs are only needed if a lib is called as main process. Thus, it is meaningful to import such libs only if this module is called as main process.</p></div>
<div class="listingblock">
<div class="content">
<pre><code><span style="color:#000000; font-weight:bold">if</span> __name__ <span style="color:#000000">==</span> <span style="color:#bf0303">'__main__'</span><span style="color:#000000">:</span>
    <span style="color:#000000; font-weight:bold">from</span> paste <span style="color:#000000; font-weight:bold">import</span> httpserver    <span style="color:#838183; font-style:italic"># Paste &lt;http://pythonpaste.org&gt;</span>
    httpserver<span style="color:#000000">.</span><span style="color:#010181">serve</span><span style="color:#000000">(</span>app<span style="color:#000000">,</span> host<span style="color:#000000">=</span><span style="color:#bf0303">'127.0.0.1'</span><span style="color:#000000">,</span> port<span style="color:#000000">=</span><span style="color:#b07e00">8080</span><span style="color:#000000">)</span></code></pre>
</div></div>
<div class="paragraph"><p>or</p></div>
<div class="listingblock">
<div class="content">
<pre><code><span style="color:#000000; font-weight:bold">if</span> __name__ <span style="color:#000000">==</span> <span style="color:#bf0303">'__main__'</span><span style="color:#000000">:</span>
    <span style="color:#000000; font-weight:bold">import</span> sys
    <span style="color:#010181">main</span><span style="color:#000000">(</span>sys<span style="color:#000000">.</span>argv<span style="color:#000000">[</span><span style="color:#b07e00">1</span><span style="color:#000000">:])</span></code></pre>
</div></div>
</div>
</div>
<div class="sect1">
<h2 id="_file_handling">7. File handling</h2>
<div class="sectionbody">
<div class="admonitionblock">
<table><tr>
<td class="icon">
<img src="../asciidoc/images/icons/tip.png" alt="Tip">
</td>
<td class="content">Detailed description at source: <a href="http://docs.python.org/2/tutorial/inputoutput.html#methods-of-file-objects">docs.python.org</a></td>
</tr></table>
</div>
<div class="paragraph"><p>It is good practice to use the <span class="monospaced">with</span> keyword when dealing with file objects. This has the advantage that the file is properly closed after its suite finishes, even if an exception is raised on the way. It is also much shorter than writing equivalent try-finally blocks:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>with <span style="color:#0057ae">open</span><span style="color:#000000">(</span><span style="color:#bf0303">'workefile'</span><span style="color:#000000">,</span> <span style="color:#bf0303">'r'</span><span style="color:#000000">)</span> <span style="color:#000000; font-weight:bold">as</span> f<span style="color:#000000">:</span>
    read_data <span style="color:#000000">=</span> f<span style="color:#000000">.</span><span style="color:#010181">read</span><span style="color:#000000">()</span>

<span style="color:#010181">doOtherStuff</span><span style="color:#000000">()</span>  <span style="color:#838183; font-style:italic"># <img src="../asciidoc/images/icons/callouts/1.png" alt="1"></span></code></pre>
</div></div>
<div class="colist arabic"><table>
<tr><td><img src="../asciidoc/images/icons/callouts/1.png" alt="1"></td><td>
f is closed here automatically even if  an exception raised
</td></tr>
</table></div>
<div class="paragraph"><p>or with multiple files</p></div>
<div class="listingblock">
<div class="content">
<pre><code>with <span style="color:#0057ae">open</span><span style="color:#000000">(</span><span style="color:#bf0303">'a'</span><span style="color:#000000">,</span> <span style="color:#bf0303">'w'</span><span style="color:#000000">)</span> <span style="color:#000000; font-weight:bold">as</span> a<span style="color:#000000">,</span> <span style="color:#0057ae">open</span><span style="color:#000000">(</span><span style="color:#bf0303">'b'</span><span style="color:#000000">,</span> <span style="color:#bf0303">'w'</span><span style="color:#000000">)</span> <span style="color:#000000; font-weight:bold">as</span> b<span style="color:#000000">:</span>
    data_a <span style="color:#000000">=</span> a<span style="color:#000000">.</span><span style="color:#010181">read</span><span style="color:#000000">()</span>
    data_b <span style="color:#000000">=</span> b<span style="color:#000000">.</span><span style="color:#010181">read</span><span style="color:#000000">()</span>

<span style="color:#010181">doOtherStuff</span><span style="color:#000000">()</span>  <span style="color:#838183; font-style:italic"># <img src="../asciidoc/images/icons/callouts/1.png" alt="1"></span></code></pre>
</div></div>
<div class="colist arabic"><table>
<tr><td><img src="../asciidoc/images/icons/callouts/1.png" alt="1"></td><td>
a and b are closed here automatically even if  an exception raised
</td></tr>
</table></div>
<div class="sect2">
<h3 id="_reading_file_in_one_line">7.1. Reading file in one line</h3>
<div class="listingblock">
<div class="content">
<pre><code><span style="color:#000000; font-weight:bold">def</span> <span style="color:#010181">_read</span><span style="color:#000000">(</span>filename<span style="color:#000000">):</span>
    <span style="color:#000000; font-weight:bold">return</span> <span style="color:#000000">[</span>line<span style="color:#000000">.</span><span style="color:#010181">split</span><span style="color:#000000">()</span> <span style="color:#000000; font-weight:bold">for</span> line <span style="color:#000000; font-weight:bold">in</span> <span style="color:#0057ae">open</span><span style="color:#000000">(</span>filename<span style="color:#000000">)]</span></code></pre>
</div></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_all___mechanism">8. __all__ mechanism</h2>
<div class="sectionbody">
<div class="paragraph"><p>Use __all__ mechanism to prevent name clashes if you import a module by <em>from M import *</em> [Source: <a href="http://www.python.org/dev/peps/pep-0008/#global-variable-names">#</a>]</p></div>
<div class="listingblock">
<div class="title">foobar.py</div>
<div class="content">
<pre><code><span style="color:#838183; font-style:italic"># Specify what is visible from other modules if current module imported by</span>
<span style="color:#838183; font-style:italic"># from M import *</span>
__all__ <span style="color:#000000">= [</span><span style="color:#bf0303">'foobar'</span><span style="color:#000000">]</span> <span style="color:#838183; font-style:italic"># only foobar is visible</span>


foobar <span style="color:#000000">=</span> <span style="color:#bf0303">'hey'</span>
foobarprivate <span style="color:#000000">=</span> <span style="color:#bf0303">'should not be seen'</span></code></pre>
</div></div>
<div class="listingblock">
<div class="title">main.py</div>
<div class="content">
<pre><code><span style="color:#000000; font-weight:bold">from</span> foobar <span style="color:#000000; font-weight:bold">import</span> <span style="color:#000000">*</span>

foobar          <span style="color:#838183; font-style:italic"># <img src="../asciidoc/images/icons/callouts/1.png" alt="1"></span>
foobarprivate   <span style="color:#838183; font-style:italic"># <img src="../asciidoc/images/icons/callouts/2.png" alt="2"></span></code></pre>
</div></div>
<div class="colist arabic"><table>
<tr><td><img src="../asciidoc/images/icons/callouts/1.png" alt="1"></td><td>
Ok
</td></tr>
<tr><td><img src="../asciidoc/images/icons/callouts/2.png" alt="2"></td><td>
Error
</td></tr>
</table></div>
</div>
</div>
<div class="sect1">
<h2 id="_class_to_handle_a_bunch_of_different_variables">9. Class to handle a bunch of different variables</h2>
<div class="sectionbody">
<div class="admonitionblock">
<table><tr>
<td class="icon">
<img src="../asciidoc/images/icons/tip.png" alt="Tip">
</td>
<td class="content">Detailed description at source: <a href="http://code.activestate.com/recipes/52308-the-simple-but-handy-collector-of-a-bunch-of-named/?in=user-97991">code.activestate.com</a></td>
</tr></table>
</div>
<div class="listingblock">
<div class="content">
<pre><code><span style="color:#000000; font-weight:bold">class</span> <span style="color:#010181">Bunch</span><span style="color:#000000">(</span><span style="color:#0057ae">dict</span><span style="color:#000000">):</span>
    <span style="color:#000000; font-weight:bold">def</span> <span style="color:#010181">__init__</span><span style="color:#000000">(</span>self<span style="color:#000000">, **</span>kw<span style="color:#000000">):</span>
        <span style="color:#0057ae">dict</span><span style="color:#000000">.</span><span style="color:#010181">__init__</span><span style="color:#000000">(</span>self<span style="color:#000000">,</span> kw<span style="color:#000000">)</span>     <span style="color:#838183; font-style:italic"># <img src="../asciidoc/images/icons/callouts/1.png" alt="1"></span>
        self<span style="color:#000000">.</span>__dict__<span style="color:#000000">.</span><span style="color:#010181">update</span><span style="color:#000000">(</span>kw<span style="color:#000000">)</span>

<span style="color:#838183; font-style:italic"># that's it!  Now, you can create a Bunch</span>
<span style="color:#838183; font-style:italic"># whenever you want to group a few variables:</span>

point <span style="color:#000000">=</span> <span style="color:#010181">Bunch</span><span style="color:#000000">(</span>datum<span style="color:#000000">=</span>y<span style="color:#000000">,</span> squared<span style="color:#000000">=</span>y<span style="color:#000000">*</span>y<span style="color:#000000">,</span> coord<span style="color:#000000">=</span>x<span style="color:#000000">)</span>

<span style="color:#838183; font-style:italic"># and of course you can read/write the named</span>
<span style="color:#838183; font-style:italic"># attributes you just created, add others, del</span>
<span style="color:#838183; font-style:italic"># some of them, etc, etc:</span>
<span style="color:#000000; font-weight:bold">if</span> point<span style="color:#000000">.</span>squared <span style="color:#000000">&gt;</span> threshold<span style="color:#000000">:</span>
    point<span style="color:#000000">.</span>isok <span style="color:#000000">=</span> <span style="color:#b07e00">1</span></code></pre>
</div></div>
<div class="colist arabic"><table>
<tr><td><img src="../asciidoc/images/icons/callouts/1.png" alt="1"></td><td>
This has the added benefit that it can directly be printed and it shows its contents in interactive environments like ipython.
</td></tr>
</table></div>
</div>
</div>
<div class="sect1">
<h2 id="_dictionary_default_value">10. Dictionary default value</h2>
<div class="sectionbody">
<div class="admonitionblock">
<table><tr>
<td class="icon">
<img src="../asciidoc/images/icons/tip.png" alt="Tip">
</td>
<td class="content">Detailed description at source: <a href="http://stackoverflow.com/questions/101268/hidden-features-of-python">stackoverflow.com</a></td>
</tr></table>
</div>
<div class="listingblock">
<div class="content">
<pre><code>d <span style="color:#000000">= {}</span>                      <span style="color:#838183; font-style:italic"># empty dictionary</span>
dafaultKey <span style="color:#000000">=</span> <span style="color:#b07e00">1234</span>           <span style="color:#838183; font-style:italic"># default value for key</span>
d<span style="color:#000000">[</span><span style="color:#bf0303">'key'</span><span style="color:#000000">]</span>                    <span style="color:#838183; font-style:italic"># -&gt; exception 'KeyError'</span>
d<span style="color:#000000">.</span><span style="color:#010181">get</span><span style="color:#000000">(</span><span style="color:#bf0303">'key'</span><span style="color:#000000">)</span>                <span style="color:#838183; font-style:italic"># -&gt; None</span>
d<span style="color:#000000">.</span><span style="color:#010181">get</span><span style="color:#000000">(</span><span style="color:#bf0303">'key'</span><span style="color:#000000">,</span> dafaultKey<span style="color:#000000">)</span>    <span style="color:#838183; font-style:italic"># -&gt; defaultKey = 1234</span>
<span style="color:#838183; font-style:italic"># Great for:</span>
d<span style="color:#000000">[</span><span style="color:#bf0303">'key'</span><span style="color:#000000">] =</span> d<span style="color:#000000">.</span><span style="color:#010181">get</span><span style="color:#000000">(</span><span style="color:#bf0303">'key'</span><span style="color:#000000">,</span> dafaultKey<span style="color:#000000">) +</span> <span style="color:#b07e00">1</span></code></pre>
</div></div>
<div class="sect2">
<h3 id="_dictionary_and_default_v2">10.1. Dictionary and default v2</h3>
<div class="paragraph"><p>Assuming you have an unknown number of parameters which have to be set to a default. For instance see following example:</p></div>
<div class="listingblock">
<div class="title">Example code</div>
<div class="content">
<pre><code><span style="color:#000000; font-weight:bold">class</span> <span style="color:#010181">SomeClass</span><span style="color:#000000">(</span><span style="color:#0057ae">object</span><span style="color:#000000">):</span>
    <span style="color:#010181">__init__</span><span style="color:#000000">(</span>self<span style="color:#000000">,</span> x<span style="color:#000000">,</span> y<span style="color:#000000">, *</span>args<span style="color:#000000">, **</span>kwargs<span style="color:#000000">):</span>
        self<span style="color:#000000">.</span>x <span style="color:#000000">=</span> x
        self<span style="color:#000000">.</span>y <span style="color:#000000">=</span> y
        self<span style="color:#000000">.</span>args <span style="color:#000000">=</span> args
        self<span style="color:#000000">.</span>kwargs <span style="color:#000000">=</span> kwargs

    <span style="color:#010181">run</span><span style="color:#000000">(</span>self<span style="color:#000000">, **</span>kwargs<span style="color:#000000">):</span>
        lskws <span style="color:#000000">=</span> <span style="color:#0057ae">dict</span><span style="color:#000000">(</span>mandatory1<span style="color:#000000">=</span><span style="color:#b07e00">10</span><span style="color:#000000">,</span> mandatory2<span style="color:#000000">=</span><span style="color:#b07e00">2</span><span style="color:#000000">)</span>
        lskws<span style="color:#000000">.</span><span style="color:#010181">update</span><span style="color:#000000">(</span>self<span style="color:#000000">.</span>kwargs<span style="color:#000000">)</span>
        lskws<span style="color:#000000">.</span><span style="color:#010181">update</span><span style="color:#000000">(</span>kwargs<span style="color:#000000">)</span>
        <span style="color:#010181">doCoolStuff</span><span style="color:#000000">(**</span>lskws<span style="color:#000000">)</span></code></pre>
</div></div>
<div class="paragraph"><p>In this example you can provide the parameter "globally" with the constructor or
by the function <span class="monospaced">run</span>. Here <span class="monospaced">mandatory1</span> and <span class="monospaced">mandatory2</span> are variables which
are required for the later function call and will be set locally in the function
to default values. The values, along with other parameters, will be overwritten
by the internal values in the property <span class="monospaced">self.kwargs</span> or by the provided parameters
in <span class="monospaced">kwargs</span>.</p></div>
<div class="paragraph"><p>The order here is, take the values provided by <span class="monospaced">kwarags</span>. If not provided, take
the parameters provided by <span class="monospaced">self.kwargs</span>. If not provided, take default values
of local parameters in <span class="monospaced">lskws</span>.</p></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_how_to_write_binary_bits_to_a_file">11. How to write binary bits to a file</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre><code><span style="color:#000000; font-weight:bold">import</span> struct                               <span style="color:#838183; font-style:italic"># <img src="../asciidoc/images/icons/callouts/1.png" alt="1"></span>

num <span style="color:#000000">= [</span><span style="color:#b07e00">1</span><span style="color:#000000">,</span><span style="color:#b07e00">2</span><span style="color:#000000">,</span><span style="color:#b07e00">3</span><span style="color:#000000">,</span><span style="color:#b07e00">4</span><span style="color:#000000">]</span>

<span style="color:#838183; font-style:italic"># 'B' : unsigned byte -&gt; 0..255</span>
data <span style="color:#000000">=</span> struct<span style="color:#000000">.</span><span style="color:#010181">pack</span><span style="color:#000000">(</span><span style="color:#bf0303">'BBBB'</span><span style="color:#000000">, *</span>num<span style="color:#000000">)</span>            <span style="color:#838183; font-style:italic"># <img src="../asciidoc/images/icons/callouts/2.png" alt="2"></span>
<span style="color:#838183; font-style:italic"># more general:</span>
data <span style="color:#000000">=</span> struct<span style="color:#000000">.</span><span style="color:#010181">pack</span><span style="color:#000000">(</span><span style="color:#bf0303">'B'</span> <span style="color:#000000">*</span> <span style="color:#0057ae">len</span><span style="color:#000000">(</span>num<span style="color:#000000">), *</span>num<span style="color:#000000">)</span>    <span style="color:#838183; font-style:italic"># <img src="../asciidoc/images/icons/callouts/2.png" alt="2"></span>

filename <span style="color:#000000">=</span> <span style="color:#bf0303">'test.bin'</span>
with <span style="color:#0057ae">open</span><span style="color:#000000">(</span>filename<span style="color:#000000">,</span> <span style="color:#bf0303">'wb'</span><span style="color:#000000">)</span> <span style="color:#000000; font-weight:bold">as</span> f<span style="color:#000000">:</span>
    f<span style="color:#000000">.</span><span style="color:#010181">write</span><span style="color:#000000">(</span>data<span style="color:#000000">)</span></code></pre>
</div></div>
<div class="colist arabic"><table>
<tr><td><img src="../asciidoc/images/icons/callouts/1.png" alt="1"></td><td>
Link: <a href="http://docs.python.org/2/library/struct.html">struct</a>
</td></tr>
<tr><td><img src="../asciidoc/images/icons/callouts/2.png" alt="2"></td><td>
Link: <a href="http://docs.python.org/2/library/struct.html#struct.pack">struct.pack</a>
</td></tr>
</table></div>
</div>
</div>
<div class="sect1">
<h2 id="_mandatory_vs_optional_arguments">12. Mandatory vs. Optional Arguments</h2>
<div class="sectionbody">
<div class="paragraph"><p>Sometimes it is useful to have arguments which are mandatory while others are not necessary because they can be predicted, inferred by other values or they have some default values.</p></div>
<div class="listingblock">
<div class="content">
<pre><code><span style="color:#000000; font-weight:bold">def</span> <span style="color:#010181">func</span><span style="color:#000000">(</span>v1<span style="color:#000000">,</span> v2<span style="color:#000000">, **</span>args<span style="color:#000000">):</span>
    defaultV3 <span style="color:#000000">= -</span><span style="color:#b07e00">1</span>
    v3 <span style="color:#000000">=</span> args<span style="color:#000000">.</span><span style="color:#010181">get</span><span style="color:#000000">(</span><span style="color:#bf0303">'v3'</span><span style="color:#000000">,</span> defaultV3<span style="color:#000000">)</span>
    <span style="color:#000000; font-weight:bold">print</span> v1<span style="color:#000000">,</span> v2<span style="color:#000000">,</span> v3

<span style="color:#010181">func</span><span style="color:#000000">(</span><span style="color:#b07e00">1</span><span style="color:#000000">,</span> <span style="color:#b07e00">2</span><span style="color:#000000">,</span> v3<span style="color:#000000">=</span><span style="color:#b07e00">22</span><span style="color:#000000">)</span>       <span style="color:#838183; font-style:italic"># <img src="../asciidoc/images/icons/callouts/1.png" alt="1"></span>
<span style="color:#010181">func</span><span style="color:#000000">(</span><span style="color:#b07e00">1</span><span style="color:#000000">,</span> <span style="color:#b07e00">2</span><span style="color:#000000">)</span>              <span style="color:#838183; font-style:italic"># <img src="../asciidoc/images/icons/callouts/2.png" alt="2"></span></code></pre>
</div></div>
<div class="colist arabic"><table>
<tr><td><img src="../asciidoc/images/icons/callouts/1.png" alt="1"></td><td>
&gt;&gt;&gt; 1  2 22
</td></tr>
<tr><td><img src="../asciidoc/images/icons/callouts/2.png" alt="2"></td><td>
&gt;&gt;&gt; 1 2 -1
</td></tr>
</table></div>
</div>
</div>
<div class="sect1">
<h2 id="_list_all_folders">13. List all Folders</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre><code><span style="color:#000000; font-weight:bold">import</span> os


folder <span style="color:#000000">= [</span>f <span style="color:#000000; font-weight:bold">for</span> f <span style="color:#000000; font-weight:bold">in</span> os<span style="color:#000000">.</span><span style="color:#010181">listdir</span><span style="color:#000000">(</span><span style="color:#bf0303">'.'</span><span style="color:#000000">)</span> <span style="color:#000000; font-weight:bold">if</span> os<span style="color:#000000">.</span>path<span style="color:#000000">.</span><span style="color:#010181">isdir</span><span style="color:#000000">(</span>f<span style="color:#000000">)]</span>                       <span style="color:#838183; font-style:italic"># <img src="../asciidoc/images/icons/callouts/1.png" alt="1"></span>

of <span style="color:#000000">=</span> <span style="color:#bf0303">'/path/to/other/folder'</span>         <span style="color:#838183; font-style:italic"># working folder</span>
folder <span style="color:#000000">= [</span>f <span style="color:#000000; font-weight:bold">for</span> f <span style="color:#000000; font-weight:bold">in</span> os<span style="color:#000000">.</span><span style="color:#010181">listdir</span><span style="color:#000000">(</span>of<span style="color:#000000">)</span> <span style="color:#000000; font-weight:bold">if</span> os<span style="color:#000000">.</span>path<span style="color:#000000">.</span><span style="color:#010181">isdir</span><span style="color:#000000">(</span>os<span style="color:#000000">.</span>path<span style="color:#000000">.</span><span style="color:#010181">join</span><span style="color:#000000">(</span>of<span style="color:#000000">,</span> f<span style="color:#000000">))]</span>      <span style="color:#838183; font-style:italic"># <img src="../asciidoc/images/icons/callouts/2.png" alt="2"></span></code></pre>
</div></div>
<div class="colist arabic"><table>
<tr><td><img src="../asciidoc/images/icons/callouts/1.png" alt="1"></td><td>
Only works if one is looking for folders in the current folder
</td></tr>
<tr><td><img src="../asciidoc/images/icons/callouts/2.png" alt="2"></td><td>
More general case
</td></tr>
</table></div>
</div>
</div>
<div class="sect1">
<h2 id="_list_comprehensions">14. List Comprehensions</h2>
<div class="sectionbody">
<div class="admonitionblock">
<table><tr>
<td class="icon">
<img src="../asciidoc/images/icons/tip.png" alt="Tip">
</td>
<td class="content">Detailed description at source: <a href="http://docs.python.org/2.7/tutorial/datastructures.html#list-comprehensions">docs.python.org</a></td>
</tr></table>
</div>
<div class="paragraph"><p>Compact way to generate specific lists.</p></div>
<div class="listingblock">
<div class="content">
<pre><code><span style="color:#000000">[(</span>x<span style="color:#000000">,</span> y<span style="color:#000000">)</span> <span style="color:#000000; font-weight:bold">for</span> x <span style="color:#000000; font-weight:bold">in</span> <span style="color:#000000">[</span><span style="color:#b07e00">1</span><span style="color:#000000">,</span> <span style="color:#b07e00">2</span><span style="color:#000000">,</span> <span style="color:#b07e00">3</span><span style="color:#000000">]</span> <span style="color:#000000; font-weight:bold">for</span> y <span style="color:#000000; font-weight:bold">in</span> <span style="color:#000000">[</span><span style="color:#b07e00">3</span><span style="color:#000000">,</span> <span style="color:#b07e00">1</span><span style="color:#000000">,</span> <span style="color:#b07e00">5</span><span style="color:#000000">]</span> <span style="color:#000000; font-weight:bold">if</span> x<span style="color:#000000">!=</span>z<span style="color:#000000">]</span>  <span style="color:#838183; font-style:italic"># <img src="../asciidoc/images/icons/callouts/1.png" alt="1"></span></code></pre>
</div></div>
<div class="colist arabic"><table>
<tr><td><img src="../asciidoc/images/icons/callouts/1.png" alt="1"></td><td>
&gt;&gt;&gt; [(1, 3), (1, 5), (2, 3), (2, 1), (2, 5), (3, 1), (3, 5)]
</td></tr>
</table></div>
<div class="sect2">
<h3 id="_unpacking_list_in_list">14.1. Unpacking list in list</h3>
<div class="listingblock">
<div class="content">
<pre><code>vec <span style="color:#000000">= [[</span><span style="color:#b07e00">1</span><span style="color:#000000">,</span> <span style="color:#b07e00">2</span><span style="color:#000000">,</span> <span style="color:#b07e00">3</span><span style="color:#000000">], [</span><span style="color:#b07e00">4</span><span style="color:#000000">,</span> <span style="color:#b07e00">5</span><span style="color:#000000">,</span> <span style="color:#b07e00">6</span><span style="color:#000000">], [</span><span style="color:#b07e00">7</span><span style="color:#000000">,</span> <span style="color:#b07e00">8</span><span style="color:#000000">,</span> <span style="color:#b07e00">9</span><span style="color:#000000">]]</span>
<span style="color:#000000">[</span>num <span style="color:#000000; font-weight:bold">for</span> elem <span style="color:#000000; font-weight:bold">in</span> vec <span style="color:#000000; font-weight:bold">for</span> num <span style="color:#000000; font-weight:bold">in</span> elem<span style="color:#000000">]</span>   <span style="color:#838183; font-style:italic"># <img src="../asciidoc/images/icons/callouts/1.png" alt="1"></span></code></pre>
</div></div>
<div class="colist arabic"><table>
<tr><td><img src="../asciidoc/images/icons/callouts/1.png" alt="1"></td><td>
&gt;&gt;&gt; [1, 2, 3, 4, 5, 6, 7, 9]
</td></tr>
</table></div>
</div>
<div class="sect2">
<h3 id="_nested_list_comprehension">14.2. Nested list comprehension</h3>
<div class="listingblock">
<div class="content">
<pre><code>matrix <span style="color:#000000">= [</span>
    <span style="color:#000000">[</span><span style="color:#b07e00">1</span><span style="color:#000000">,</span> <span style="color:#b07e00">5</span><span style="color:#000000">,</span> <span style="color:#b07e00">9</span><span style="color:#000000">],</span>
    <span style="color:#000000">[</span><span style="color:#b07e00">2</span><span style="color:#000000">,</span> <span style="color:#b07e00">6</span><span style="color:#000000">,</span> <span style="color:#b07e00">10</span><span style="color:#000000">],</span>
    <span style="color:#000000">[</span><span style="color:#b07e00">3</span><span style="color:#000000">,</span> <span style="color:#b07e00">7</span><span style="color:#000000">,</span> <span style="color:#b07e00">11</span><span style="color:#000000">],</span>
    <span style="color:#000000">[</span><span style="color:#b07e00">4</span><span style="color:#000000">,</span> <span style="color:#b07e00">8</span><span style="color:#000000">,</span> <span style="color:#b07e00">12</span><span style="color:#000000">]</span>
<span style="color:#000000">]</span>

matrix_trans <span style="color:#000000">= [[</span>row<span style="color:#000000">[</span>n<span style="color:#000000">]</span> <span style="color:#000000; font-weight:bold">for</span> row <span style="color:#000000; font-weight:bold">in</span> matrix<span style="color:#000000">]</span> <span style="color:#000000; font-weight:bold">for</span> n <span style="color:#000000; font-weight:bold">in</span> <span style="color:#0057ae">range</span><span style="color:#000000">(</span><span style="color:#0057ae">len</span><span style="color:#000000">(</span>matrix<span style="color:#000000">))]</span>
<span style="color:#000000; font-weight:bold">print</span> matrix_trans      <span style="color:#838183; font-style:italic"># <img src="../asciidoc/images/icons/callouts/1.png" alt="1"></span></code></pre>
</div></div>
<div class="colist arabic"><table>
<tr><td><img src="../asciidoc/images/icons/callouts/1.png" alt="1"></td><td>
&gt;&gt;&gt; [[1, 2, 3, 4], [5, 6, 7, 8], [9, 10, 11, 12]]
</td></tr>
</table></div>
</div>
<div class="sect2">
<h3 id="_slice_copy_when_changing_a_list_while_iterate_over_same_list">14.3. Slice copy when changing a list while iterate over same list</h3>
<div class="paragraph"><p>To change a sequence you are iterating over while inside the loop (for example to duplicate certain items), it is recommended that you first make a copy. Looping over a sequence does not implicitly make a copy. The slice notation makes this especially convenient [<a href="http://docs.python.org/2.7/tutorial/datastructures.html#looping-techniques">#</a>]:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>words <span style="color:#000000">= [</span><span style="color:#bf0303">'cat'</span><span style="color:#000000">,</span> <span style="color:#bf0303">'window'</span><span style="color:#000000">,</span> <span style="color:#bf0303">'defenestrate'</span><span style="color:#000000">]</span>
<span style="color:#000000; font-weight:bold">for</span> w <span style="color:#000000; font-weight:bold">in</span> words<span style="color:#000000">[:]:</span>  <span style="color:#838183; font-style:italic"># Loop over a slice copy of the entire list.</span>
    <span style="color:#000000; font-weight:bold">if</span> <span style="color:#0057ae">len</span><span style="color:#000000">(</span>w<span style="color:#000000">) &gt;</span> <span style="color:#b07e00">6</span><span style="color:#000000">:</span>
        words<span style="color:#000000">.</span><span style="color:#010181">insert</span><span style="color:#000000">(</span><span style="color:#b07e00">0</span><span style="color:#000000">,</span> w<span style="color:#000000">)</span>

words       <span style="color:#838183; font-style:italic"># <img src="../asciidoc/images/icons/callouts/1.png" alt="1"></span></code></pre>
</div></div>
<div class="colist arabic"><table>
<tr><td><img src="../asciidoc/images/icons/callouts/1.png" alt="1"></td><td>
&gt;&gt;&gt; [<em>defenestrate</em>, <em>cat</em>, <em>window</em>, <em>defenestrate</em>]
</td></tr>
</table></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_looping_techniques">15. Looping Techniques</h2>
<div class="sectionbody">
<div class="admonitionblock">
<table><tr>
<td class="icon">
<img src="../asciidoc/images/icons/tip.png" alt="Tip">
</td>
<td class="content">
<div class="ulist"><ul>
<li>
<p>
Detailed description at source: <a href="http://docs.python.org/2.7/tutorial/datastructures.html#looping-techniques">docs.python.org</a>
</p>
</li>
<li>
<p>
todo
</p>
</li>
</ul></div>
</td>
</tr></table>
</div>
<div class="sect2">
<h3 id="_list">15.1. List</h3>
<div class="paragraph"><p>To retreive index and value use <span class="monospaced">enumerate()</span>.</p></div>
<div class="listingblock">
<div class="content">
<pre><code><span style="color:#000000; font-weight:bold">for</span> i<span style="color:#000000">,</span> v <span style="color:#000000; font-weight:bold">in</span> <span style="color:#0057ae">enumerate</span><span style="color:#000000">([</span><span style="color:#bf0303">'tic'</span><span style="color:#000000">,</span> <span style="color:#bf0303">'tac'</span><span style="color:#000000">,</span> <span style="color:#bf0303">'toe'</span><span style="color:#000000">]):</span>
    <span style="color:#000000; font-weight:bold">print</span> i<span style="color:#000000">,</span> v</code></pre>
</div></div>
</div>
<div class="sect2">
<h3 id="_dictionary">15.2. Dictionary</h3>
<div class="paragraph"><p>Iterate over the complete dictionary.</p></div>
<div class="listingblock">
<div class="content">
<pre><code>d <span style="color:#000000">= {</span><span style="color:#bf0303">'xxx'</span><span style="color:#000000">:</span> <span style="color:#bf0303">'fuu'</span><span style="color:#000000">,</span> <span style="color:#bf0303">'ggg'</span><span style="color:#000000">:</span> <span style="color:#bf0303">'bar'</span><span style="color:#000000">,</span> <span style="color:#bf0303">'aaa'</span><span style="color:#000000">:</span> <span style="color:#bf0303">'fuubar'</span><span style="color:#000000">,</span> <span style="color:#bf0303">'123'</span><span style="color:#000000">:</span> <span style="color:#bf0303">'fuu bar fuubar'</span><span style="color:#000000">}</span>
<span style="color:#000000; font-weight:bold">for</span> k<span style="color:#000000">,</span> v <span style="color:#000000; font-weight:bold">in</span> d<span style="color:#000000">.</span><span style="color:#010181">iteritems</span><span style="color:#000000">():</span>  <span style="color:#838183; font-style:italic"># <img src="../asciidoc/images/icons/callouts/1.png" alt="1"></span>
    <span style="color:#000000; font-weight:bold">print</span> k<span style="color:#000000">,</span> v

<span style="color:#838183; font-style:italic"># or</span>
<span style="color:#000000; font-weight:bold">for</span> k<span style="color:#000000">,</span> v <span style="color:#000000; font-weight:bold">in</span> d<span style="color:#000000">.</span><span style="color:#010181">items</span><span style="color:#000000">():</span>      <span style="color:#838183; font-style:italic"># <img src="../asciidoc/images/icons/callouts/2.png" alt="2"></span>
    <span style="color:#000000; font-weight:bold">print</span> k<span style="color:#000000">,</span> v</code></pre>
</div></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<img src="../asciidoc/images/icons/note.png" alt="Note">
</td>
<td class="content">The difference between &lt;1&gt; and &lt;2&gt; is that dict.items() returns a list of
2-tuples ([(key, value), (key, value), &#8230;]) whereas dict.iteritems returns a
generator that yields 2-typles:</td>
</tr></table>
</div>
<div class="listingblock">
<div class="content">
<pre><code><span style="color:#000000">&gt;&gt;&gt;</span> d<span style="color:#000000">.</span><span style="color:#010181">items</span><span style="color:#000000">()</span>
<span style="color:#000000">[(</span><span style="color:#bf0303">'123'</span><span style="color:#000000">,</span> <span style="color:#bf0303">'fuu bar fuubar'</span><span style="color:#000000">), (</span><span style="color:#bf0303">'ggg'</span><span style="color:#000000">,</span> <span style="color:#bf0303">'bar'</span><span style="color:#000000">), (</span><span style="color:#bf0303">'xxx'</span><span style="color:#000000">,</span> <span style="color:#bf0303">'fuu'</span><span style="color:#000000">), (</span><span style="color:#bf0303">'aaa'</span><span style="color:#000000">,</span> <span style="color:#bf0303">'fuubar'</span><span style="color:#000000">)]</span>
<span style="color:#000000">&gt;&gt;&gt;</span> d<span style="color:#000000">.</span><span style="color:#010181">iteritems</span><span style="color:#000000">()</span>
<span style="color:#000000">&lt;</span>dictionary<span style="color:#000000">-</span>itemiterator at <span style="color:#b07e00">0x368bc00</span><span style="color:#000000">&gt;</span></code></pre>
</div></div>
<div class="sect3">
<h4 id="_ordered_dictionary">15.2.1. (ordered) Dictionary</h4>
<div class="paragraph"><p>Iterating over a dictionary does not guarantee a specific order. Thus, you
cannot guarantee a certain order of (key, value)-pairs. For this you can use <span class="monospaced">sorted(...)</span>:</p></div>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre><code><span style="color:#000000">&gt;&gt;&gt;</span> <span style="color:#0057ae">sorted</span><span style="color:#000000">(</span>d<span style="color:#000000">.</span><span style="color:#010181">items</span><span style="color:#000000">())</span>
<span style="color:#000000">[(</span><span style="color:#bf0303">'123'</span><span style="color:#000000">,</span> <span style="color:#bf0303">'fuu bar fuubar'</span><span style="color:#000000">), (</span><span style="color:#bf0303">'aaa'</span><span style="color:#000000">,</span> <span style="color:#bf0303">'fuubar'</span><span style="color:#000000">), (</span><span style="color:#bf0303">'ggg'</span><span style="color:#000000">,</span> <span style="color:#bf0303">'bar'</span><span style="color:#000000">), (</span><span style="color:#bf0303">'xxx'</span><span style="color:#000000">,</span> <span style="color:#bf0303">'fuu'</span><span style="color:#000000">)]</span>
<span style="color:#000000">&gt;&gt;&gt;</span> <span style="color:#0057ae">sorted</span><span style="color:#000000">(</span>d<span style="color:#000000">.</span><span style="color:#010181">iteritems</span><span style="color:#000000">())</span>
<span style="color:#000000">[(</span><span style="color:#bf0303">'123'</span><span style="color:#000000">,</span> <span style="color:#bf0303">'fuu bar fuubar'</span><span style="color:#000000">), (</span><span style="color:#bf0303">'aaa'</span><span style="color:#000000">,</span> <span style="color:#bf0303">'fuubar'</span><span style="color:#000000">), (</span><span style="color:#bf0303">'ggg'</span><span style="color:#000000">,</span> <span style="color:#bf0303">'bar'</span><span style="color:#000000">), (</span><span style="color:#bf0303">'xxx'</span><span style="color:#000000">,</span> <span style="color:#bf0303">'fuu'</span><span style="color:#000000">)]</span></code></pre>
</div></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<img src="../asciidoc/images/icons/note.png" alt="Note">
</td>
<td class="content">Using this technique yields a list of 2D-tubple in both cases. Getting back
the generator can be done by:</td>
</tr></table>
</div>
<div class="listingblock">
<div class="content">
<pre><code><span style="color:#000000">&gt;&gt;&gt;</span> it <span style="color:#000000">=</span> <span style="color:#0057ae">iter</span><span style="color:#000000">(</span><span style="color:#0057ae">sorted</span><span style="color:#000000">(</span>d<span style="color:#000000">.</span><span style="color:#010181">iteritems</span><span style="color:#000000">()))</span>
<span style="color:#000000">&gt;&gt;&gt;</span> it<span style="color:#000000">.</span><span style="color:#010181">next</span><span style="color:#000000">()</span>
<span style="color:#000000">(</span><span style="color:#bf0303">'123'</span><span style="color:#000000">,</span> <span style="color:#bf0303">'fuu bar fuubar'</span><span style="color:#000000">)</span>
<span style="color:#000000">&gt;&gt;&gt;</span> k<span style="color:#000000">,</span> v <span style="color:#000000">=</span> it<span style="color:#000000">.</span><span style="color:#010181">next</span><span style="color:#000000">()</span>
<span style="color:#000000">&gt;&gt;&gt;</span> <span style="color:#000000; font-weight:bold">print</span> k<span style="color:#000000">,</span> v
aaa fuubar</code></pre>
</div></div>
<div class="sect4">
<h5 id="_ordereddict">OrderedDict</h5>
<div class="paragraph"><p>Annother approach to guarantee a specific order you can
use the <a href="http://docs.python.org/dev/library/collections.html#collections.OrderedDict"><span class="monospaced">OrderedDict</span></a> from the module <span class="monospaced">collection</span>. This class can be used just as normal dictionaries. This dictionary remembers the order of insterions
and will iterate like so.</p></div>
<div class="listingblock">
<div class="content">
<pre><code><span style="color:#000000; font-weight:bold">import</span> collections

d <span style="color:#000000">= {}</span>
o <span style="color:#000000">=</span> collections<span style="color:#000000">.</span><span style="color:#010181">OrderedDict</span><span style="color:#000000">()</span>

<span style="color:#838183; font-style:italic"># add to regular dictionary</span>
d<span style="color:#000000">[</span><span style="color:#bf0303">'a'</span><span style="color:#000000">] =</span> <span style="color:#b07e00">1</span>
d<span style="color:#000000">[</span><span style="color:#bf0303">'b'</span><span style="color:#000000">] =</span> <span style="color:#b07e00">2</span>
d<span style="color:#000000">[</span><span style="color:#bf0303">'c'</span><span style="color:#000000">] =</span> <span style="color:#b07e00">3</span>

<span style="color:#838183; font-style:italic"># add to ordered dictionary</span>
o<span style="color:#000000">[</span><span style="color:#bf0303">'a'</span><span style="color:#000000">] =</span> <span style="color:#b07e00">1</span>
o<span style="color:#000000">[</span><span style="color:#bf0303">'b'</span><span style="color:#000000">] =</span> <span style="color:#b07e00">2</span>
o<span style="color:#000000">[</span><span style="color:#bf0303">'c'</span><span style="color:#000000">] =</span> <span style="color:#b07e00">3</span>

<span style="color:#838183; font-style:italic"># print both. o returns pairs in order added</span>
<span style="color:#000000; font-weight:bold">print</span> d
<span style="color:#000000; font-weight:bold">print</span> o

<span style="color:#838183; font-style:italic"># you can still reference by key</span>
<span style="color:#000000; font-weight:bold">print</span> d<span style="color:#000000">[</span><span style="color:#bf0303">'a'</span><span style="color:#000000">]</span>
<span style="color:#000000; font-weight:bold">print</span> o<span style="color:#000000">[</span><span style="color:#bf0303">'a'</span><span style="color:#000000">]</span></code></pre>
</div></div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_how_to_determine_type_of_variable">16. How to determine type of variable</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre><code><span style="color:#0057ae">type</span><span style="color:#000000">([]])</span> <span style="color:#000000; font-weight:bold">is</span> <span style="color:#0057ae">list</span>   <span style="color:#838183; font-style:italic"># <img src="../asciidoc/images/icons/callouts/1.png" alt="1"></span></code></pre>
</div></div>
<div class="colist arabic"><table>
<tr><td><img src="../asciidoc/images/icons/callouts/1.png" alt="1"></td><td>
<span class="monospaced">&gt;&gt;&gt; True</span>
</td></tr>
</table></div>
<div class="listingblock">
<div class="title">Examples</div>
<div class="content">
<pre><code>i <span style="color:#000000">=</span> <span style="color:#b07e00">123</span>
<span style="color:#0057ae">type</span><span style="color:#000000">(</span>i<span style="color:#000000">)</span>             <span style="color:#838183; font-style:italic"># <img src="../asciidoc/images/icons/callouts/1.png" alt="1"></span>
<span style="color:#0057ae">type</span><span style="color:#000000">(</span>i<span style="color:#000000">)</span> <span style="color:#000000; font-weight:bold">is</span> <span style="color:#0057ae">int</span>      <span style="color:#838183; font-style:italic"># <img src="../asciidoc/images/icons/callouts/2.png" alt="2"></span>
i <span style="color:#000000">=</span> <span style="color:#b07e00">123456789L</span>
<span style="color:#0057ae">type</span><span style="color:#000000">(</span>i<span style="color:#000000">)</span>             <span style="color:#838183; font-style:italic"># <img src="../asciidoc/images/icons/callouts/3.png" alt="3"></span>
<span style="color:#0057ae">type</span><span style="color:#000000">(</span>i<span style="color:#000000">)</span> <span style="color:#000000; font-weight:bold">is</span> <span style="color:#0057ae">long</span>     <span style="color:#838183; font-style:italic"># <img src="../asciidoc/images/icons/callouts/4.png" alt="4"></span>
i <span style="color:#000000">=</span> <span style="color:#b07e00">123.456</span>
<span style="color:#0057ae">type</span><span style="color:#000000">(</span>i<span style="color:#000000">)</span>             <span style="color:#838183; font-style:italic"># <img src="../asciidoc/images/icons/callouts/5.png" alt="5"></span>
<span style="color:#0057ae">type</span><span style="color:#000000">(</span>i<span style="color:#000000">)</span> <span style="color:#000000; font-weight:bold">is</span> <span style="color:#0057ae">float</span>    <span style="color:#838183; font-style:italic"># <img src="../asciidoc/images/icons/callouts/6.png" alt="6"></span></code></pre>
</div></div>
<div class="colist arabic"><table>
<tr><td><img src="../asciidoc/images/icons/callouts/1.png" alt="1"></td><td>
<span class="monospaced">&gt;&gt;&gt; &lt;type 'int'&gt;</span>
</td></tr>
<tr><td><img src="../asciidoc/images/icons/callouts/2.png" alt="2"></td><td>
<span class="monospaced">&gt;&gt;&gt; True</span>
</td></tr>
<tr><td><img src="../asciidoc/images/icons/callouts/3.png" alt="3"></td><td>
<span class="monospaced">&gt;&gt;&gt; &lt;type 'long'&gt;</span>
</td></tr>
<tr><td><img src="../asciidoc/images/icons/callouts/4.png" alt="4"></td><td>
<span class="monospaced">&gt;&gt;&gt; True</span>
</td></tr>
<tr><td><img src="../asciidoc/images/icons/callouts/5.png" alt="5"></td><td>
<span class="monospaced">&gt;&gt;&gt; &lt;type 'float'&gt;</span>
</td></tr>
<tr><td><img src="../asciidoc/images/icons/callouts/6.png" alt="6"></td><td>
<span class="monospaced">&gt;&gt;&gt; True</span>
</td></tr>
</table></div>
</div>
</div>
<div class="sect1">
<h2 id="_string_formatting">17. String formatting</h2>
<div class="sectionbody">
<div class="admonitionblock">
<table><tr>
<td class="icon">
<img src="../asciidoc/images/icons/tip.png" alt="Tip">
</td>
<td class="content">
<div class="ulist"><ul>
<li>
<p>
<a href="http://docs.python.org/2.7/tutorial/inputoutput.html">inputoutput.html</a>
</p>
</li>
</ul></div>
</td>
</tr></table>
</div>
<div class="listingblock">
<div class="title">Using .format()</div>
<div class="content">
<pre><code><span style="color:#000000; font-weight:bold">print</span> <span style="color:#bf0303">'We are the {} who say &quot;{}!&quot;'</span><span style="color:#000000">.</span><span style="color:#010181">format</span><span style="color:#000000">(</span><span style="color:#bf0303">'knights'</span><span style="color:#000000">,</span> <span style="color:#bf0303">'Ni'</span><span style="color:#000000">)</span>     <span style="color:#838183; font-style:italic"># <img src="../asciidoc/images/icons/callouts/1.png" alt="1"></span></code></pre>
</div></div>
<div class="colist arabic"><table>
<tr><td><img src="../asciidoc/images/icons/callouts/1.png" alt="1"></td><td>
<span class="monospaced">&gt;&gt;&gt; We are the knights who say "Ni!"</span>
</td></tr>
</table></div>
<div class="paragraph"><p>or</p></div>
<div class="sect2">
<h3 id="_positioning_of_format_fields">17.1. Positioning of format fields</h3>
<div class="paragraph"><p>The brackets and characters within them (called format fields) are replaced with the objects passed into the <span class="monospaced">str.format()</span> method. A number in the brackets refers to the position of the object passed into the <span class="monospaced">str.format()</span> method.</p></div>
<div class="listingblock">
<div class="title">With numbers</div>
<div class="content">
<pre><code><span style="color:#000000; font-weight:bold">print</span> <span style="color:#bf0303">'{0} and {1}'</span><span style="color:#000000">.</span><span style="color:#010181">format</span><span style="color:#000000">(</span><span style="color:#bf0303">'spam'</span><span style="color:#000000">,</span> <span style="color:#bf0303">'eggs'</span><span style="color:#000000">)</span>      <span style="color:#838183; font-style:italic"># <img src="../asciidoc/images/icons/callouts/1.png" alt="1"></span>

<span style="color:#000000; font-weight:bold">print</span> <span style="color:#bf0303">'{1} and {0}'</span><span style="color:#000000">.</span><span style="color:#010181">format</span><span style="color:#000000">(</span><span style="color:#bf0303">'spam'</span><span style="color:#000000">,</span> <span style="color:#bf0303">'eggs'</span><span style="color:#000000">)</span>      <span style="color:#838183; font-style:italic"># <img src="../asciidoc/images/icons/callouts/2.png" alt="2"></span></code></pre>
</div></div>
<div class="colist arabic"><table>
<tr><td><img src="../asciidoc/images/icons/callouts/1.png" alt="1"></td><td>
<span class="monospaced">&gt;&gt;&gt; spam and eggs</span>
</td></tr>
<tr><td><img src="../asciidoc/images/icons/callouts/2.png" alt="2"></td><td>
<span class="monospaced">&gt;&gt;&gt; eggs and spam</span>
</td></tr>
</table></div>
<div class="listingblock">
<div class="title">With keys</div>
<div class="content">
<pre><code><span style="color:#000000; font-weight:bold">print</span> <span style="color:#bf0303">'This {food} is {adjective}.'</span><span style="color:#000000">.</span><span style="color:#010181">format</span><span style="color:#000000">(</span>food<span style="color:#000000">=</span><span style="color:#bf0303">'spam'</span><span style="color:#000000">,</span> adjective<span style="color:#000000">=</span><span style="color:#bf0303">'absolutely horrible'</span><span style="color:#000000">)</span>    <span style="color:#838183; font-style:italic"># <img src="../asciidoc/images/icons/callouts/1.png" alt="1"></span></code></pre>
</div></div>
<div class="colist arabic"><table>
<tr><td><img src="../asciidoc/images/icons/callouts/1.png" alt="1"></td><td>
<span class="monospaced">&gt;&gt;&gt; This spam is absolutely horrible.</span>
</td></tr>
</table></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_variable_number_of_arguments">18. Variable number of arguments</h2>
<div class="sectionbody">
<div class="admonitionblock">
<table><tr>
<td class="icon">
<img src="../asciidoc/images/icons/tip.png" alt="Tip">
</td>
<td class="content">
<div class="ulist"><ul>
<li>
<p>
<a href="http://www.saltycrane.com/blog/2008/01/how-to-use-args-and-kwargs-in-python/">how-to-use-args-and-kwargs-in-python</a>
</p>
</li>
</ul></div>
</td>
</tr></table>
</div>
<div class="listingblock">
<div class="title">Multiple key-value arguments</div>
<div class="content">
<pre><code><span style="color:#000000; font-weight:bold">def</span> <span style="color:#010181">myfunc</span><span style="color:#000000">(**</span>kwargs<span style="color:#000000">):</span>
    <span style="color:#838183; font-style:italic"># kwargs is a dictionary.</span>
    <span style="color:#000000; font-weight:bold">for</span> k<span style="color:#000000">,</span>v <span style="color:#000000; font-weight:bold">in</span> kwargs<span style="color:#000000">.</span><span style="color:#010181">iteritems</span><span style="color:#000000">():</span>
         <span style="color:#000000; font-weight:bold">print</span> <span style="color:#bf0303">&quot;</span><span style="color:#0057ae">%s </span><span style="color:#bf0303">=</span> <span style="color:#0057ae">%s</span><span style="color:#bf0303">&quot;</span> % <span style="color:#000000">(</span>k<span style="color:#000000">,</span> v<span style="color:#000000">)</span>

<span style="color:#010181">myfunc</span><span style="color:#000000">(</span>abc<span style="color:#000000">=</span><span style="color:#b07e00">123</span><span style="color:#000000">,</span> efh<span style="color:#000000">=</span><span style="color:#b07e00">456</span><span style="color:#000000">)</span>        <span style="color:#838183; font-style:italic"># <img src="../asciidoc/images/icons/callouts/1.png" alt="1"></span>

keywords <span style="color:#000000">= {</span><span style="color:#bf0303">'abc'</span><span style="color:#000000">:</span> <span style="color:#b07e00">123</span><span style="color:#000000">,</span> <span style="color:#bf0303">'efh'</span><span style="color:#000000">:</span> <span style="color:#b07e00">456</span><span style="color:#000000">}</span>
<span style="color:#010181">myfunc</span><span style="color:#000000">(**</span>keywords<span style="color:#000000">)</span>              <span style="color:#838183; font-style:italic"># <img src="../asciidoc/images/icons/callouts/2.png" alt="2"></span></code></pre>
</div></div>
<div class="colist arabic"><table>
<tr><td><img src="../asciidoc/images/icons/callouts/1.png" alt="1"></td><td>
<span class="monospaced">&gt;&gt;&gt; abc = 123</span>
<div class="paragraph"><p><span class="monospaced">&gt;&gt;&gt; efh = 456</span></p></div>
</td></tr>
<tr><td><img src="../asciidoc/images/icons/callouts/2.png" alt="2"></td><td>
&lt;1&gt; and &lt;2&gt; are equivalent
</td></tr>
</table></div>
<div class="listingblock">
<div class="title">Mix of list an key-value arguments</div>
<div class="content">
<pre><code><span style="color:#000000; font-weight:bold">def</span> <span style="color:#010181">myfunc2</span><span style="color:#000000">(*</span>args<span style="color:#000000">, **</span>kwargs<span style="color:#000000">):</span>   <span style="color:#838183; font-style:italic"># <img src="../asciidoc/images/icons/callouts/1.png" alt="1"></span>
   <span style="color:#000000; font-weight:bold">for</span> a <span style="color:#000000; font-weight:bold">in</span> args<span style="color:#000000">:</span>
       <span style="color:#000000; font-weight:bold">print</span> a
   <span style="color:#000000; font-weight:bold">for</span> k<span style="color:#000000">,</span>v <span style="color:#000000; font-weight:bold">in</span> kwargs<span style="color:#000000">.</span><span style="color:#010181">iteritems</span><span style="color:#000000">():</span>
       <span style="color:#000000; font-weight:bold">print</span> <span style="color:#bf0303">&quot;</span><span style="color:#0057ae">%s </span><span style="color:#bf0303">=</span> <span style="color:#0057ae">%s</span><span style="color:#bf0303">&quot;</span> % <span style="color:#000000">(</span>k<span style="color:#000000">,</span> v<span style="color:#000000">)</span>

<span style="color:#010181">myfunc2</span><span style="color:#000000">(</span><span style="color:#b07e00">1</span><span style="color:#000000">,</span> <span style="color:#b07e00">2</span><span style="color:#000000">,</span> <span style="color:#b07e00">3</span><span style="color:#000000">,</span> banan<span style="color:#000000">=</span><span style="color:#b07e00">123</span><span style="color:#000000">)</span>     <span style="color:#838183; font-style:italic"># <img src="../asciidoc/images/icons/callouts/2.png" alt="2"></span>

keywords <span style="color:#000000">= {</span><span style="color:#bf0303">'banan'</span><span style="color:#000000">:</span> <span style="color:#b07e00">123</span><span style="color:#000000">}</span>
listargs <span style="color:#000000">= [</span><span style="color:#b07e00">1</span><span style="color:#000000">,</span><span style="color:#b07e00">2</span><span style="color:#000000">,</span><span style="color:#b07e00">3</span><span style="color:#000000">]</span>
<span style="color:#010181">myfunc2</span><span style="color:#000000">(*</span>listargs<span style="color:#000000">, **</span>keywords<span style="color:#000000">)</span>     <span style="color:#838183; font-style:italic"># <img src="../asciidoc/images/icons/callouts/3.png" alt="3"></span></code></pre>
</div></div>
<div class="colist arabic"><table>
<tr><td><img src="../asciidoc/images/icons/callouts/1.png" alt="1"></td><td>
<span class="monospaced">*args</span> = list arguments; <span class="monospaced">**kwargs</span> = keyword arguments
</td></tr>
<tr><td><img src="../asciidoc/images/icons/callouts/2.png" alt="2"></td><td>
<span class="monospaced">&gt;&gt;&gt; 1</span>
<div class="paragraph"><p><span class="monospaced">&gt;&gt;&gt; 2</span></p></div>
<div class="paragraph"><p><span class="monospaced">&gt;&gt;&gt; 3</span></p></div>
<div class="paragraph"><p><span class="monospaced">&gt;&gt;&gt; banan = 123</span></p></div>
</td></tr>
<tr><td><img src="../asciidoc/images/icons/callouts/3.png" alt="3"></td><td>
&#8594; &lt;2&gt; and &lt;3&gt; are equivalent
</td></tr>
</table></div>
</div>
</div>
<div class="sect1">
<h2 id="_kwargs_vs_named_arguments_keywords">19. **kwargs vs. named arguments (keywords)</h2>
<div class="sectionbody">
<div class="paragraph"><p>In many cases it is useful to provide a variable number of arguments. Often many arguments
can be inferred or set to a default value. This can be done
by <span class="monospaced">def func1(*args, **kwargs)</span> or <span class="monospaced">def func2(x, *args, plot=True, debug=True)</span>.
So, when to use which idiom?</p></div>
<div class="paragraph"><p>While the fromer version has the main advantage that the
list of named arguments is more arbitrary than the latter, it&#8217;s readability is much
worse. For example one caller has to read the docstring assuming their exists one and
it is consistent with the source code or, worse, he has to read the source code.
Also, the latter version provides a fast grasp of the possible arguments and assuming
the arguments are given appropriate names, the user understands its meaning without
reading the docstring or source code at all.</p></div>
<div class="paragraph"><p>Furthermore, the latter version could be called with positional
arguments like <span class="monospaced">func2(x, y, True, False)</span> while the latter version always has to be called
like <span class="monospaced">func1(x, y, plot=True, debug=False)</span>. A good example is the
<a href="http://docs.python.org/2/library/subprocess.html#popen-constructor">subprocess.Popen</a>
Construrctor:</p></div>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre><code><span style="color:#000000; font-weight:bold">class</span> <span style="color:#010181">Popen</span><span style="color:#000000">(</span><span style="color:#0057ae">object</span><span style="color:#000000">):</span>
    <span style="color:#000000; font-weight:bold">def</span> <span style="color:#010181">__init__</span><span style="color:#000000">(</span>self<span style="color:#000000">,</span> args<span style="color:#000000">,</span> bufsize<span style="color:#000000">=</span><span style="color:#b07e00">0</span><span style="color:#000000">,</span> executable<span style="color:#000000">=</span><span style="color:#000000; font-weight:bold">None</span><span style="color:#000000">,</span>
                 stdin<span style="color:#000000">=</span><span style="color:#000000; font-weight:bold">None</span><span style="color:#000000">,</span> stdout<span style="color:#000000">=</span><span style="color:#000000; font-weight:bold">None</span><span style="color:#000000">,</span> stderr<span style="color:#000000">=</span><span style="color:#000000; font-weight:bold">None</span><span style="color:#000000">,</span>
                 preexec_fn<span style="color:#000000">=</span><span style="color:#000000; font-weight:bold">None</span><span style="color:#000000">,</span> close_fds<span style="color:#000000">=</span><span style="color:#000000; font-weight:bold">False</span><span style="color:#000000">,</span> shell<span style="color:#000000">=</span><span style="color:#000000; font-weight:bold">False</span><span style="color:#000000">,</span>
                 cwd<span style="color:#000000">=</span><span style="color:#000000; font-weight:bold">None</span><span style="color:#000000">,</span> env<span style="color:#000000">=</span><span style="color:#000000; font-weight:bold">None</span><span style="color:#000000">,</span> universal_newlines<span style="color:#000000">=</span><span style="color:#000000; font-weight:bold">False</span><span style="color:#000000">,</span>
                 startupinfo<span style="color:#000000">=</span><span style="color:#000000; font-weight:bold">None</span><span style="color:#000000">,</span> creationflags<span style="color:#000000">=</span><span style="color:#b07e00">0</span><span style="color:#000000">):</span>
        <span style="color:#bf0303">&quot;&quot;&quot;Create new Popen instance.&quot;&quot;&quot;</span>
        <span style="color:#000000">...</span></code></pre>
</div></div>
<div class="paragraph"><p>While there exist reasons to use the former version, my suggestion would be
to use the latter version <span class="monospaced">def func2(x, *args, plot=True, debug=True)</span> in most cases.</p></div>
<div class="paragraph"><p>If you want, for some reason, ensure that some arguments are "keyword-only" arguments
and thus will never be automatically filled in by positional argument, the
<a href="http://www.python.org/dev/peps/pep-3102/">pep3102</a> is the way to go.</p></div>
<div class="listingblock">
<div class="title">2 Positional arguments and keywords arguments</div>
<div class="content">
<pre><code><span style="color:#000000; font-weight:bold">def</span> <span style="color:#010181">compare</span><span style="color:#000000">(</span>a<span style="color:#000000">,</span> b<span style="color:#000000">, *</span>ignore<span style="color:#000000">,</span> key<span style="color:#000000">=</span><span style="color:#000000; font-weight:bold">None</span><span style="color:#000000">):</span>
    <span style="color:#000000; font-weight:bold">if</span> ignore<span style="color:#000000">:</span>  <span style="color:#838183; font-style:italic"># If ignore is not empty</span>
        <span style="color:#000000; font-weight:bold">raise</span> <span style="color:#000000; font-weight:bold">TypeError</span>
    <span style="color:#000000">...</span></code></pre>
</div></div>
<div class="paragraph"><p>In this case <span class="monospaced">compare(1,2,'key')</span> will result in an error while <span class="monospaced">compare(1,2,key='key')</span>
or <span class="monospaced">compare(1,2)</span> will give the intended behavior.</p></div>
<div class="paragraph"><p>The former version should be used if the number and/or names of the arguments is
not known in advanced. For example for writing a wrapper function which mainly calls
another function and where the parameter only should be passed on to the other
function. A good example is the <span class="monospaced">subprocess.call</span> function which is in
principle only a wrapper function which creates a <span class="monospaced">Popen</span> object and waits until
the process has been finished.</p></div>
<div class="listingblock">
<div class="title">Example call of subprocess package</div>
<div class="content">
<pre><code><span style="color:#000000; font-weight:bold">def</span> <span style="color:#010181">call</span><span style="color:#000000">(*</span>popenargs<span style="color:#000000">, **</span>kwargs<span style="color:#000000">):</span>
    <span style="color:#bf0303">&quot;&quot;&quot;Run command with arguments.  Wait for command to complete, then</span>
<span style="color:#bf0303">    return the returncode attribute.</span>
<span style="color:#bf0303"></span>
<span style="color:#bf0303">    The arguments are the same as for the Popen constructor.  Example:</span>
<span style="color:#bf0303"></span>
<span style="color:#bf0303">    retcode = call([&quot;ls&quot;, &quot;-l&quot;])</span>
<span style="color:#bf0303">    &quot;&quot;&quot;</span>
    <span style="color:#000000; font-weight:bold">return</span> <span style="color:#010181">Popen</span><span style="color:#000000">(*</span>popenargs<span style="color:#000000">, **</span>kwargs<span style="color:#000000">).</span><span style="color:#010181">wait</span><span style="color:#000000">()</span></code></pre>
</div></div>
<div class="paragraph"><p>The main advantage here is that, suppose the argument list in the <span class="monospaced">Popen</span>
constructor changed, the <span class="monospaced">call</span> function does not have to be changed at all. Thus
there is no additional maintenance here as it would be in the other case.</p></div>
<div class="sect2">
<h3 id="_mixins_with_default_values">19.1. Mixins with default values</h3>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<img src="../asciidoc/images/icons/tip.png" alt="Tip">
</td>
<td class="content">
<div class="ulist"><ul>
<li>
<p>
<a href="http://www.network-theory.co.uk/docs/pytut/DefaultArgumentValues.html">DefaultArgumentValues</a>
</p>
</li>
</ul></div>
</td>
</tr></table>
</div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<img src="../asciidoc/images/icons/warning.png" alt="Warning">
</td>
<td class="content">
<div class="paragraph"><p><strong>Important warning</strong>: The default value is evaluated only once. This makes a difference when the default is a mutable object such as a list, dictionary, or instances of most classes. Thus, it is often better to have a default value of <span class="monospaced">None</span> and create the default object inside the function.</p></div>
</td>
</tr></table>
</div>
<div class="paragraph"><p>Often it is useful to provide default values for the arguments which haven&#8217;t been provided to the function.</p></div>
<div class="paragraph"><p>The following source code is an example of function with two variables which are mandatory and following optional argument list and dictionary. Note: the dictionary optional values has to be at end since it is not allowed to have a non-keyword argument after a keyword argument. This raises a <span class="monospaced"><strong><span class="red">SyntaxError:</span> non-keyword arg after keyword arg</strong></span> exception.</p></div>
<div class="listingblock">
<div class="title">Example code for mix of mandatory args and optional list and keyword args</div>
<div class="content">
<pre><code><span style="color:#000000; font-weight:bold">def</span> <span style="color:#010181">func</span><span style="color:#000000">(</span>mandatoryArg1<span style="color:#000000">,</span> mandatoryArg2<span style="color:#000000">, *</span>optionalList<span style="color:#000000">=</span><span style="color:#000000; font-weight:bold">None</span><span style="color:#000000">, **</span>optionalDict<span style="color:#000000">=</span><span style="color:#000000; font-weight:bold">None</span><span style="color:#000000">):</span>
    someList <span style="color:#000000">= [</span><span style="color:#b07e00">1</span><span style="color:#000000">,</span><span style="color:#b07e00">2</span><span style="color:#000000">,</span><span style="color:#b07e00">3</span><span style="color:#000000">]</span>

    default <span style="color:#000000">= [</span>
        <span style="color:#000000">{</span><span style="color:#bf0303">'key'</span><span style="color:#000000">:</span> foo<span style="color:#bf0303">', '</span>default<span style="color:#bf0303">': '</span><span style="color:#b07e00">123</span><span style="color:#bf0303">'}</span>
<span style="color:#bf0303">        {'</span>key<span style="color:#bf0303">': foobar'</span><span style="color:#000000">,</span> <span style="color:#bf0303">'default'</span><span style="color:#000000">:</span> <span style="color:#bf0303">'3.14'</span><span style="color:#000000">}</span>
    <span style="color:#000000">]</span>

    <span style="color:#000000; font-weight:bold">if</span> <span style="color:#000000">(</span><span style="color:#000000; font-weight:bold">not</span> optionalList <span style="color:#000000; font-weight:bold">is None and</span> <span style="color:#0057ae">len</span><span style="color:#000000">(</span>optionalList<span style="color:#000000">) &gt;</span> <span style="color:#b07e00">0</span><span style="color:#000000">):</span>
        someList <span style="color:#000000">=</span> optionalList

    <span style="color:#000000; font-weight:bold">if</span> <span style="color:#000000">(</span>optionalDict <span style="color:#000000; font-weight:bold">is None</span><span style="color:#000000">):</span>
        optionalDict <span style="color:#000000">= {}</span>

    <span style="color:#838183; font-style:italic"># get default value if not provide by callee and save it in dictionary</span>
    foo <span style="color:#000000">=</span> optionalDict<span style="color:#000000">.</span><span style="color:#010181">get</span><span style="color:#000000">(</span>default<span style="color:#000000">[</span><span style="color:#b07e00">0</span><span style="color:#000000">][</span><span style="color:#bf0303">'key'</span><span style="color:#000000">],</span> default<span style="color:#000000">[</span><span style="color:#b07e00">0</span><span style="color:#000000">][</span><span style="color:#bf0303">'default'</span><span style="color:#000000">])</span>
    optionalDict<span style="color:#000000">[</span>default<span style="color:#000000">[</span><span style="color:#b07e00">0</span><span style="color:#000000">][</span><span style="color:#bf0303">'key'</span><span style="color:#000000">]] =</span> foo

    foobar <span style="color:#000000">=</span> optionalDict<span style="color:#000000">.</span><span style="color:#010181">get</span><span style="color:#000000">(</span>default<span style="color:#000000">[</span><span style="color:#b07e00">1</span><span style="color:#000000">][</span><span style="color:#bf0303">'key'</span><span style="color:#000000">],</span> default<span style="color:#000000">[</span><span style="color:#b07e00">1</span><span style="color:#000000">][</span><span style="color:#bf0303">'default'</span><span style="color:#000000">])</span>
    optionalDict<span style="color:#000000">[</span>default<span style="color:#000000">[</span><span style="color:#b07e00">1</span><span style="color:#000000">][</span><span style="color:#bf0303">'key'</span><span style="color:#000000">]] =</span> foobar

    <span style="color:#010181">doSomething</span><span style="color:#000000">(</span>mandatoryArg1<span style="color:#000000">,</span> mandatoryArg2<span style="color:#000000">, *</span>someList<span style="color:#000000">, **</span>optionalDict<span style="color:#000000">)</span></code></pre>
</div></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_relative_path_from_source_file">20. Relative path from source file</h2>
<div class="sectionbody">
<div class="paragraph"><p>If you want to call a program relative to the current source file it is not possible to just use <span class="monospaced">../bin/foobar</span> since <span class="monospaced">Popen()</span> or its equivalent <span class="monospaced">subprocess.call()</span> needs the absolute of the program.</p></div>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre><code><span style="color:#838183; font-style:italic">#/usr/bin/env python</span>
<span style="color:#000000; font-weight:bold">from</span> subprocess <span style="color:#000000; font-weight:bold">import</span> Popen<span style="color:#000000">,</span> PIPE
<span style="color:#000000; font-weight:bold">from</span> os<span style="color:#000000">.</span>path <span style="color:#000000; font-weight:bold">import</span> abspath<span style="color:#000000">,</span> dirname<span style="color:#000000">,</span> join

path <span style="color:#000000">=</span> <span style="color:#010181">abspath</span><span style="color:#000000">(</span><span style="color:#010181">join</span><span style="color:#000000">(</span><span style="color:#010181">dirname</span><span style="color:#000000">(</span>__file__<span style="color:#000000">),</span> <span style="color:#bf0303">'../bin/foobar'</span><span style="color:#000000">))</span>
spam<span style="color:#000000">,</span> eggs <span style="color:#000000">=</span> <span style="color:#010181">Popen</span><span style="color:#000000">(</span>path<span style="color:#000000">,</span> stdout<span style="color:#000000">=</span>PIPE<span style="color:#000000">,</span> stderr<span style="color:#000000">=</span>PIPE<span style="color:#000000">).</span><span style="color:#010181">communicate</span><span style="color:#000000">()</span></code></pre>
</div></div>
</div>
</div>
<div class="sect1">
<h2 id="_duck_typing">21. Duck-typing</h2>
<div class="sectionbody">
<div class="quoteblock">
<div class="content">
<div class="paragraph"><p>A programming style which does not look at an object’s type to determine if it has the right interface; instead, the method or attribute is simply called or used (“If it looks like a duck and quacks like a duck, it must be a duck.”) By emphasizing interfaces rather than specific types, well-designed code improves its flexibility by allowing polymorphic substitution. Duck-typing avoids tests using type() or isinstance(). (Note, however, that duck-typing can be complemented with abstract base classes.) Instead, it typically employs hasattr() tests or EAFP programming.</p></div>
</div>
<div class="attribution">
<em>python docs</em><br>
&#8212; <a href="http://docs.python.org/2/glossary.html#term-duck-typing">term-duck-typing</a>
</div></div>
<div class="listingblock">
<div class="title">Example with exception [<a href="https://en.wikipedia.org/wiki/Duck_typing#In_Python">wiki</a>]</div>
<div class="content">
<pre><code><span style="color:#000000; font-weight:bold">try</span><span style="color:#000000">:</span>
    mallard<span style="color:#000000">.</span><span style="color:#010181">quack</span><span style="color:#000000">()</span>
<span style="color:#000000; font-weight:bold">except</span> <span style="color:#000000">(</span><span style="color:#000000; font-weight:bold">AttributeError</span><span style="color:#000000">,</span> <span style="color:#000000; font-weight:bold">TypeError</span><span style="color:#000000">):</span>
    <span style="color:#000000; font-weight:bold">print</span><span style="color:#000000">(</span><span style="color:#bf0303">&quot;mallard can't quack()&quot;</span><span style="color:#000000">)</span></code></pre>
</div></div>
<div class="paragraph"><p>Since <span class="monospaced">hasattr(object, name)</span> does almost the same job and is well optimized it should be preferred where applicable.</p></div>
<div class="listingblock">
<div class="title">Example same example with <span class="monospaced">hasattr</span></div>
<div class="content">
<pre><code><span style="color:#000000; font-weight:bold">if</span> <span style="color:#000000">(</span><span style="color:#0057ae">hasattr</span><span style="color:#000000">(</span>mallard<span style="color:#000000">,</span> <span style="color:#bf0303">'quack'</span><span style="color:#000000">)):</span>
    mallard<span style="color:#000000">.</span><span style="color:#010181">quack</span><span style="color:#000000">()</span>
<span style="color:#000000; font-weight:bold">else</span><span style="color:#000000">:</span>
    <span style="color:#000000; font-weight:bold">print</span><span style="color:#000000">(</span><span style="color:#bf0303">&quot;mallard can't quack()&quot;</span><span style="color:#000000">)</span></code></pre>
</div></div>
</div>
</div>
<div class="sect1">
<h2 id="_testing_python_code">22. Testing python code</h2>
<div class="sectionbody">
<div class="paragraph"><p>In general there exists two main testing mechanisms one is <a href="http://docs.python.org/2/library/unittest.html">unittest</a> and the other is <a href="http://docs.python.org/2/library/doctest.html">doctest</a>. Both are good ways to verify that the code is correct. However both testing mechanisms have their drawbacks.</p></div>
<div class="paragraph"><p>While doctest clutters the docstring, it is a good way to give examples and to see if the docstring is consistent with the actual source code.</p></div>
<div class="paragraph"><p>Unitetest keeps the actual testing separate from the source code, which helps to not blow up the source code, but it does not check if docstring and source code are consistent.</p></div>
<div class="paragraph"><p>Nevertheless I find it a good practice to combine both methods, but to reverse the usage of docsttest. Thus, the docstring is used as a way to provide examples how to use the method and to see if the docstring is consistent with the source code. The actual and comprehensive testing is done by a unittest.</p></div>
<div class="sidebarblock">
<div class="content">
<div class="title">Summary</div>
<div class="ulist"><ul>
<li>
<p>
<a href="http://docs.python.org/2/library/unittest.html">unittest</a>: comprehensive testing
</p>
</li>
<li>
<p>
<a href="http://docs.python.org/2/library/doctest.html">doctest</a>: provide examples in docstring and check if docstring is consistent with source code.
</p>
</li>
</ul></div>
</div></div>
</div>
</div>
<div class="sect1">
<h2 id="_relative_imports_for_non_package_modules">23. Relative imports for non-package modules</h2>
<div class="sectionbody">
<div class="paragraph"><p>In order to allow relative import for non-package modules or for package modules which are called as main (important for testing mechanisms), you have to add code to your script.</p></div>
<div class="paragraph"><p>Assuming the module is in <span class="monospaced">httpserver.lib</span> and the main package is <span class="monospaced">httpserver</span>. Then you can add the following code to enable the module to be called as main script (read <a href="http://www.python.org/dev/peps/pep-0366/">pep-366</a> for more detailes).</p></div>
<div class="listingblock">
<div class="title">This code has to be place above any relative import</div>
<div class="content">
<pre><code><span style="color:#838183; font-style:italic"># enable relative import if this script is called as main</span>
<span style="color:#838183; font-style:italic"># see: http://www.python.org/dev/peps/pep-0366/</span>
<span style="color:#838183; font-style:italic"># if __name__ == &quot;__main__&quot; and __package__ is None:</span>
<span style="color:#838183; font-style:italic">#    __package__ = &quot;expected.package.name&quot;</span>
<span style="color:#838183; font-style:italic"># Note that this boilerplate is sufficient only if the top level package</span>
<span style="color:#838183; font-style:italic"># is already accessible via sys.path. Additional code that manipulates</span>
<span style="color:#838183; font-style:italic"># sys.path would be needed in order for direct execution to work without</span>
<span style="color:#838183; font-style:italic"># the top level package already being importable.&quot;</span>
<span style="color:#000000; font-weight:bold">if</span> __name__ <span style="color:#000000">==</span> <span style="color:#bf0303">&quot;__main__&quot;</span><span style="color:#000000">:</span>       <span style="color:#838183; font-style:italic"># <img src="../asciidoc/images/icons/callouts/1.png" alt="1"></span>
    <span style="color:#000000; font-weight:bold">if</span> __package__ <span style="color:#000000; font-weight:bold">is None</span><span style="color:#000000">:</span>
        <span style="color:#000000; font-weight:bold">import</span> sys
        <span style="color:#000000; font-weight:bold">import</span> os
        <span style="color:#838183; font-style:italic"># add &quot;./../../&quot; to sys.path to enable import of package httpserver</span>
        sys<span style="color:#000000">.</span>path<span style="color:#000000">.</span><span style="color:#010181">append</span><span style="color:#000000">(</span>
            os<span style="color:#000000">.</span>path<span style="color:#000000">.</span><span style="color:#010181">abspath</span><span style="color:#000000">(</span>
                os<span style="color:#000000">.</span>path<span style="color:#000000">.</span><span style="color:#010181">join</span><span style="color:#000000">(</span>
                     os<span style="color:#000000">.</span>path<span style="color:#000000">.</span><span style="color:#010181">join</span><span style="color:#000000">(</span>os<span style="color:#000000">.</span>path<span style="color:#000000">.</span><span style="color:#010181">dirname</span><span style="color:#000000">(</span>__file__<span style="color:#000000">),</span> <span style="color:#bf0303">&quot;..&quot;</span><span style="color:#000000">),</span> <span style="color:#bf0303">&quot;..&quot;</span><span style="color:#000000">)))</span>
        <span style="color:#000000; font-weight:bold">import</span> httpserver    <span style="color:#838183; font-style:italic"># load main package to enable relative module import</span>
        __package__ <span style="color:#000000">=</span> <span style="color:#bf0303">&quot;httpserver.lib&quot;</span></code></pre>
</div></div>
<div class="colist arabic"><table>
<tr><td><img src="../asciidoc/images/icons/callouts/1.png" alt="1"></td><td>
If the current module is loaded from another module, which is called as main, this <span class="monospaced">if</span> has to be omitted.
</td></tr>
</table></div>
</div>
</div>
<div class="sect1">
<h2 id="_python_and_optimization">24. Python and optimization</h2>
<div class="sectionbody">
<div class="paragraph"><p>If you run a python script without optimization this is normally invoked in debug mode (check <a href="https://docs.python.org/2/library/constants.html?highlight=%5F%5Fdebug%5F%5F#%5F%5Fdebug%5F%5F">__debug__</a>). This means for example that all
assertions will be tested. You can test if python is running in debug mode by invoking following code:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>    $ python <span style="color:#000000">-</span>c <span style="color:#bf0303">'print __debug__'</span>
    True
    $ python <span style="color:#000000">-</span>c <span style="color:#bf0303">'assert False, &quot;assert&quot;'</span>
    Traceback <span style="color:#000000">(</span>most recent call last<span style="color:#000000">):</span>
      File <span style="color:#bf0303">&quot;&lt;string&gt;&quot;</span><span style="color:#000000">,</span> line <span style="color:#b07e00">1</span><span style="color:#000000">,</span> <span style="color:#000000; font-weight:bold">in</span> <span style="color:#000000">&lt;</span>module<span style="color:#000000">&gt;</span>
    AssertionError<span style="color:#000000">:</span> assert</code></pre>
</div></div>
<div class="paragraph"><p>Turning optimization on by passing <span class="monospaced">-O</span> or <span class="monospaced">-OO</span> to python, will optimize the script (the latter will also discard the docstring in favor for optimal code), which includes that alle assertions
will be ignored (see <span class="monospaced">man python</span> or <a href="https://docs.python.org/2/using/cmdline.html?highlight=#-O">html</a> for more details;
or just invoke <span class="monospaced">python -h</span>).</p></div>
<div class="listingblock">
<div class="content">
<pre><code>    $ python <span style="color:#000000">-</span>OO <span style="color:#000000">-</span>c <span style="color:#bf0303">'print __debug__'</span>
    False
    $ python <span style="color:#000000">-</span>O <span style="color:#000000">-</span>c <span style="color:#bf0303">'assert False, &quot;assert&quot;'</span>
    <span style="color:#000000">&lt;</span>blank<span style="color:#000000">&gt;</span> <span style="color:#838183; font-style:italic"># &lt;- assertion should have been thrown if it wasn't be ignored</span></code></pre>
</div></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<img src="../asciidoc/images/icons/tip.png" alt="Tip">
</td>
<td class="content">For testing you should run your scripts in debug mode. To deploy or running the scripts in actual task (assuming you
have tested everything properly) you should run your scripts in optimzation mode.</td>
</tr></table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_check_if_assertion_turned_off">25. Check if assertion turned off</h2>
<div class="sectionbody">
<div class="paragraph"><p>Assertions are useful for several things such as:</p></div>
<div class="ulist"><ul>
<li>
<p>
Design by contract (pre-/post condition test)
</p>
</li>
<li>
<p>
Early recognition of bugs
</p>
</li>
<li>
<p>
etc.
</p>
</li>
</ul></div>
<div class="paragraph"><p>They should be used only for checking the code and not for flow control or other
things. For this case <span class="monospaced">if ... else</span> or <span class="monospaced">try ... except ... finally</span> are made for.</p></div>
<div class="paragraph"><p>If you want to deploy the software you always should turn <span class="monospaced">DEBUG</span> to <span class="monospaced">0</span> and shall
either write wrapper script which calls the script with the python command <span class="monospaced">-O</span> or
you should highlight that the script shall be called with this command.</p></div>
<div class="paragraph"><p>In some cases assertions can slow down the code, this is why you should use the
optimization mode of python. To ensure this, you can insert following code
snippet in your main file or setting file which checks if python ignores all
assertions otherwise it throws an assertion with a description.</p></div>
<div class="listingblock">
<div class="content">
<pre><code>DEBUG <span style="color:#000000">=</span> <span style="color:#b07e00">0</span>
<span style="color:#000000; font-weight:bold">if not</span> DEBUG<span style="color:#000000">:</span>
    <span style="color:#000000; font-weight:bold">import</span> sys
    <span style="color:#000000; font-weight:bold">import</span> os
    as_msg <span style="color:#000000">=</span> <span style="color:#bf0303">&quot;&quot;&quot;This script has been configured such it runs in release mode.</span>
<span style="color:#bf0303">    Since the scripts makes excessive use of assertion for development you should</span>
<span style="color:#bf0303">    run this script with &quot;python -O {script_name}&quot; to neglect assertions or</span>
<span style="color:#bf0303">    switch back to debug mode by setting setting.DEBUG = 1.</span>
<span style="color:#bf0303">&quot;&quot;&quot;</span><span style="color:#000000">.</span><span style="color:#010181">format</span><span style="color:#000000">(</span>script_name<span style="color:#000000">=</span>os<span style="color:#000000">.</span>path<span style="color:#000000">.</span><span style="color:#010181">basename</span><span style="color:#000000">(</span>sys<span style="color:#000000">.</span>argv<span style="color:#000000">[</span><span style="color:#b07e00">0</span><span style="color:#000000">]))</span>
    <span style="color:#000000; font-weight:bold">assert False</span><span style="color:#000000">,</span> as_msg</code></pre>
</div></div>
<div class="paragraph"><p>For a more detailed description of assertions and how to use them read <a href="https://mail.python.org/pipermail/python-list/2013-November/660401.html">When to use assert</a>.</p></div>
</div>
</div>
<div class="sect1">
<h2 id="_properties">26. Properties</h2>
<div class="sectionbody">
<div class="admonitionblock">
<table><tr>
<td class="icon">
<img src="../asciidoc/images/icons/important.png" alt="Important">
</td>
<td class="content">Python is not Java or C/C++ &#8594; There are no private member variables which shall
be accessed by getter/setter functions. Thus, don&#8217;t write getter/setter functions
but access all variables directly unless not otherwise possible or meaningful. Then
use properties!</td>
</tr></table>
</div>
<div class="paragraph"><p>A big advantage of using property decorator for setting/getting is to have
control of how variables should be read from or written to. For example you want
want to prevent a variable to be positive (validating) or before you returning a variable
you want to recompute something etc. This can be ensured by ordinary getter/setter
methods or by the <span class="monospaced">@property</span> decorator. The property decorator is superior when
code should be more flexible. For instance if you have written a Library which has
been deployed already and you decided to instead of just returning a value you want
to recompute or refetch from remote a new value which shall be returned. Thus you
can hide this behavior behind the property decorator without braking code which
uses your library. Additionally if you decided to recompute or update something
when a variable changes you can also hide this in property setter method without
braking existing code.</p></div>
<div class="paragraph"><p>One disadvantage is the reduced performance which, in most cases, can be neglected.</p></div>
<div class="paragraph"><p>Another area where the property is useful is design-by-contract where you always
can check pro/post condition and class invariants in the development stage and when
it comes to the release mode you can just roll back and rename all variables and
comment the property decorator to be as efficient as possible.</p></div>
<div class="paragraph"><p>In addition you don&#8217;t have to write getter/setter just in case you want to have
control. You can write a variable without the double underscores and if you
decide you want to have more control added properties for those variables and change
the local variable to have leading underscores but not using refactoring in this
case which would change all access to this variable also.</p></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<img src="../asciidoc/images/icons/note.png" alt="Note">
</td>
<td class="content">
<div class="title">Syntactic sugar</div>This concept is in general syntactic sugar which allows method calls to like
variable access or assignment.</td>
</tr></table>
</div>
<div class="sect2">
<h3 id="_decorator">26.1. Decorator</h3>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<img src="../asciidoc/images/icons/tip.png" alt="Tip">
</td>
<td class="content">Read <a href="http://legacy.python.org/dev/peps/pep-0318/">pep-318</a> for more information</td>
</tr></table>
</div>
<div class="paragraph"><p>Decorate each function with purpose. <span class="monospaced">@property</span> has to start each property.</p></div>
<div class="listingblock">
<div class="title">Example code</div>
<div class="content">
<pre><code><span style="color:#000000; font-weight:bold">class</span> <span style="color:#010181">Sphere</span><span style="color:#000000">(</span><span style="color:#0057ae">object</span><span style="color:#000000">):</span>
    <span style="color:#000000; font-weight:bold">def</span> <span style="color:#010181">__init__</span><span style="color:#000000">(</span>self<span style="color:#000000">,</span> radius<span style="color:#000000">,</span> center<span style="color:#000000">):</span>
        self<span style="color:#000000">.</span>_radius <span style="color:#000000">=</span> radius
        self<span style="color:#000000">.</span>_center <span style="color:#000000">=</span> center

    <span style="color:#0057ae">&#64;property</span>
    <span style="color:#000000; font-weight:bold">def</span> <span style="color:#010181">radius</span><span style="color:#000000">(</span>self<span style="color:#000000">):</span>
        <span style="color:#000000; font-weight:bold">print</span> <span style="color:#bf0303">&quot;radius getter is used&quot;</span>
        <span style="color:#000000; font-weight:bold">return</span> self<span style="color:#000000">.</span>__radius

    <span style="color:#0057ae">&#64;radius</span><span style="color:#000000">.</span>setter
    <span style="color:#000000; font-weight:bold">def</span> <span style="color:#010181">radius</span><span style="color:#000000">(</span>self<span style="color:#000000">,</span> radius<span style="color:#000000">):</span>
        <span style="color:#000000; font-weight:bold">if</span> radius <span style="color:#000000">&lt;</span> <span style="color:#b07e00">0</span><span style="color:#000000">:</span>
            <span style="color:#000000; font-weight:bold">raise</span> <span style="color:#000000; font-weight:bold">TypeError</span><span style="color:#000000">(</span><span style="color:#bf0303">&quot;Radius should never be negative&quot;</span><span style="color:#000000">)</span>
        self<span style="color:#000000">.</span>__radius <span style="color:#000000">=</span> radius

<span style="color:#000000">&gt;&gt;&gt;</span> s <span style="color:#000000">=</span> <span style="color:#010181">Sphere</span><span style="color:#000000">(</span><span style="color:#b07e00">1</span><span style="color:#000000">, [</span><span style="color:#b07e00">1</span><span style="color:#000000">,</span><span style="color:#b07e00">1</span><span style="color:#000000">,</span><span style="color:#b07e00">1</span><span style="color:#000000">])</span>
<span style="color:#000000">&gt;&gt;&gt;</span> s<span style="color:#000000">.</span>radius <span style="color:#000000">=</span> <span style="color:#b07e00">2</span>
<span style="color:#000000">&gt;&gt;&gt;</span> <span style="color:#000000; font-weight:bold">print</span> s<span style="color:#000000">.</span>radius
radius getter <span style="color:#000000; font-weight:bold">is</span> used
<span style="color:#b07e00">2</span>
<span style="color:#000000">&gt;&gt;&gt;</span> s<span style="color:#000000">.</span>radius <span style="color:#000000">= -</span><span style="color:#b07e00">1</span>
<span style="color:#000000; font-weight:bold">TypeError</span><span style="color:#000000">:</span> Radius should never be negative
<span style="color:#000000">&gt;&gt;&gt;</span> <span style="color:#000000; font-weight:bold">print</span> s<span style="color:#000000">.</span>radius
radius getter <span style="color:#000000; font-weight:bold">is</span> used
<span style="color:#b07e00">2</span></code></pre>
</div></div>
<div class="ulist"><ul>
<li>
<p>
Convention for private variables <a href="http://docs.python.org/3/tutorial/classes.html#private-variables">private-variables</a>.
</p>
</li>
<li>
<p>
Another good link to why to use <a href="http://stackoverflow.com/a/6618176/1959528">stackoverflow.com</a>
</p>
</li>
</ul></div>
</div>
<div class="sect2">
<h3 id="_using_constructor">26.2. Using constructor</h3>
<div class="paragraph"><p>Source: article: <a href="http://tomayko.com/writings/getters-setters-fuxors">http://tomayko.com/writings/getters-setters-fuxors</a></p></div>
<div class="paragraph"><p>Calling <a href="http://docs.python.org/2/library/functions.html?highlight=property#property">property constructor</a> for each property.</p></div>
<div class="listingblock">
<div class="title">Example code</div>
<div class="content">
<pre><code><span style="color:#000000; font-weight:bold">class</span> <span style="color:#010181">Contact</span><span style="color:#000000">(</span><span style="color:#0057ae">object</span><span style="color:#000000">):</span>

    <span style="color:#000000; font-weight:bold">def</span> <span style="color:#010181">__init__</span><span style="color:#000000">(</span>self<span style="color:#000000">,</span> first_name<span style="color:#000000">=</span><span style="color:#000000; font-weight:bold">None</span><span style="color:#000000">,</span> last_name<span style="color:#000000">=</span><span style="color:#000000; font-weight:bold">None</span><span style="color:#000000">,</span>
                 display_name<span style="color:#000000">=</span><span style="color:#000000; font-weight:bold">None</span><span style="color:#000000">,</span> email<span style="color:#000000">=</span><span style="color:#000000; font-weight:bold">None</span><span style="color:#000000">):</span>
        self<span style="color:#000000">.</span>first_name <span style="color:#000000">=</span> first_name
        self<span style="color:#000000">.</span>last_name <span style="color:#000000">=</span> last_name
        self<span style="color:#000000">.</span>display_name <span style="color:#000000">=</span> display_name
        self<span style="color:#000000">.</span>email <span style="color:#000000">=</span> email

    <span style="color:#000000; font-weight:bold">def</span> <span style="color:#010181">print_info</span><span style="color:#000000">(</span>self<span style="color:#000000">):</span>
        <span style="color:#000000; font-weight:bold">print</span> self<span style="color:#000000">.</span>display_name<span style="color:#000000">,</span> <span style="color:#bf0303">&quot;&lt;&quot;</span> <span style="color:#000000">+</span> self<span style="color:#000000">.</span>email <span style="color:#000000">+</span> <span style="color:#bf0303">&quot;&gt;&quot;</span>

    <span style="color:#000000; font-weight:bold">def</span> <span style="color:#010181">set_email</span><span style="color:#000000">(</span>self<span style="color:#000000">,</span> value<span style="color:#000000">):</span>
        <span style="color:#000000; font-weight:bold">if</span> <span style="color:#bf0303">'&#64;'</span> <span style="color:#000000; font-weight:bold">not in</span> value<span style="color:#000000">:</span>
            <span style="color:#000000; font-weight:bold">raise</span> <span style="color:#000000; font-weight:bold">Exception</span><span style="color:#000000">(</span><span style="color:#bf0303">&quot;This doesn't look like an email address.&quot;</span><span style="color:#000000">)</span>
        self<span style="color:#000000">.</span>_email <span style="color:#000000">=</span> value

    <span style="color:#000000; font-weight:bold">def</span> <span style="color:#010181">get_email</span><span style="color:#000000">(</span>self<span style="color:#000000">):</span>
        <span style="color:#000000; font-weight:bold">return</span> self<span style="color:#000000">.</span>_email

    email <span style="color:#000000">=</span> <span style="color:#0057ae">property</span><span style="color:#000000">(</span>get_email<span style="color:#000000">,</span> set_email<span style="color:#000000">)</span></code></pre>
</div></div>
<div class="paragraph"><p>The following code will still run properly but now checks if email contains a <em>@</em>:</p></div>
<div class="listingblock">
<div class="title">Example code</div>
<div class="content">
<pre><code>contact <span style="color:#000000">=</span> <span style="color:#010181">Contact</span><span style="color:#000000">()</span>
contact<span style="color:#000000">.</span>email <span style="color:#000000">=</span> <span style="color:#bf0303">&quot;x&#64;x.com&quot;</span>   <span style="color:#838183; font-style:italic"># ok</span>
contact<span style="color:#000000">.</span>email <span style="color:#000000">=</span> <span style="color:#bf0303">&quot;xx.com&quot;</span>    <span style="color:#838183; font-style:italic"># Exception</span></code></pre>
</div></div>
</div>
<div class="sect2">
<h3 id="_private_variables">26.3. Private variables</h3>
<div class="paragraph"><p>"Any identifier of the form __spam (at least two leading underscores, at most one trailing underscore) is textually replaced with _classname__spam, where classname is the current class name with leading underscore(s) stripped."
This prevents a sublcass from using self.__spam!</p></div>
<div class="listingblock">
<div class="title">Example code</div>
<div class="content">
<pre><code><span style="color:#000000; font-weight:bold">class</span> <span style="color:#010181">C</span><span style="color:#000000">(</span><span style="color:#0057ae">object</span><span style="color:#000000">):</span>
    __name <span style="color:#000000">=</span> <span style="color:#000000; font-weight:bold">None</span>
    _name2 <span style="color:#000000">=</span> <span style="color:#000000; font-weight:bold">None</span>

<span style="color:#000000; font-weight:bold">class</span> <span style="color:#010181">D</span><span style="color:#000000">(</span>C<span style="color:#000000">):</span>
    <span style="color:#000000; font-weight:bold">pass</span>

<span style="color:#000000">&gt;&gt;&gt;</span> d <span style="color:#000000">=</span> <span style="color:#010181">D</span><span style="color:#000000">()</span>
<span style="color:#000000">&gt;&gt;&gt;</span> <span style="color:#0057ae">dir</span><span style="color:#000000">(</span>d<span style="color:#000000">)</span>
<span style="color:#000000">[</span><span style="color:#bf0303">'_C__name'</span><span style="color:#000000">,</span>        <span style="color:#838183; font-style:italic"># &lt;&lt;&lt; notice _C in front of name -&gt; thus, this variable can be used in the current Class only</span>
 <span style="color:#bf0303">'__class__'</span><span style="color:#000000">,</span>
 <span style="color:#bf0303">'__delattr__'</span><span style="color:#000000">,</span>
 <span style="color:#bf0303">'__dict__'</span><span style="color:#000000">,</span>
 <span style="color:#bf0303">'__doc__'</span><span style="color:#000000">,</span>
 <span style="color:#bf0303">'__format__'</span><span style="color:#000000">,</span>
 <span style="color:#bf0303">'__getattribute__'</span><span style="color:#000000">,</span>
 <span style="color:#bf0303">'__hash__'</span><span style="color:#000000">,</span>
 <span style="color:#bf0303">'__init__'</span><span style="color:#000000">,</span>
 <span style="color:#bf0303">'__module__'</span><span style="color:#000000">,</span>
 <span style="color:#bf0303">'__new__'</span><span style="color:#000000">,</span>
 <span style="color:#bf0303">'__reduce__'</span><span style="color:#000000">,</span>
 <span style="color:#bf0303">'__reduce_ex__'</span><span style="color:#000000">,</span>
 <span style="color:#bf0303">'__repr__'</span><span style="color:#000000">,</span>
 <span style="color:#bf0303">'__setattr__'</span><span style="color:#000000">,</span>
 <span style="color:#bf0303">'__sizeof__'</span><span style="color:#000000">,</span>
 <span style="color:#bf0303">'__str__'</span><span style="color:#000000">,</span>
 <span style="color:#bf0303">'__subclasshook__'</span><span style="color:#000000">,</span>
 <span style="color:#bf0303">'__weakref__'</span><span style="color:#000000">,</span>
 <span style="color:#bf0303">'_name2'</span><span style="color:#000000">]</span>          <span style="color:#838183; font-style:italic"># &lt;&lt;&lt; has not been changed -&gt; thus, this property can be easily used in sublcasses</span></code></pre>
</div></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_override_and_implements_decorators">27. @override and @implements decorators</h2>
<div class="sectionbody">
<div class="paragraph"><p>The following <span class="monospaced">@overrides</span> and <span class="monospaced">@implements</span> decoratos can be used to show
that the following functions overrides or implements the method from super class.
It also copies the <span class="monospaced">__doc__</span> string from the super method if it is not specified
in the new function. <a href="http://pydev.blogspot.de/2011/06/overrideimplements-templates-on-pydev.html">src</a></p></div>
<div class="listingblock">
<div class="title">decoratos.py</div>
<div class="content">
<pre><code><span style="color:#000000; font-weight:bold">def</span> <span style="color:#010181">overrides</span><span style="color:#000000">(</span>method<span style="color:#000000">):</span>
    <span style="color:#000000; font-weight:bold">def</span> <span style="color:#010181">wrapper</span><span style="color:#000000">(</span>func<span style="color:#000000">):</span>
        <span style="color:#000000; font-weight:bold">if</span> func<span style="color:#000000">.</span>__name__ <span style="color:#000000">!=</span> method<span style="color:#000000">.</span>__name__<span style="color:#000000">:</span>
            msg <span style="color:#000000">=</span> <span style="color:#bf0303">&quot;Wrong &#64;override:</span> <span style="color:#0057ae">%r ex</span><span style="color:#bf0303">pected, but overwriting</span> <span style="color:#0057ae">%r</span><span style="color:#bf0303">.&quot;</span>
            msg <span style="color:#000000">=</span> msg % <span style="color:#000000">(</span>func<span style="color:#000000">.</span>__name__<span style="color:#000000">,</span> method<span style="color:#000000">.</span>__name__<span style="color:#000000">)</span>
            <span style="color:#000000; font-weight:bold">raise</span> <span style="color:#000000; font-weight:bold">AssertionError</span><span style="color:#000000">(</span>msg<span style="color:#000000">)</span>

        <span style="color:#000000; font-weight:bold">if</span> func<span style="color:#000000">.</span>__doc__ <span style="color:#000000; font-weight:bold">is None</span><span style="color:#000000">:</span>
            func<span style="color:#000000">.</span>__doc__ <span style="color:#000000">=</span> method<span style="color:#000000">.</span>__doc__

        <span style="color:#000000; font-weight:bold">return</span> func

    <span style="color:#000000; font-weight:bold">return</span> wrapper


<span style="color:#000000; font-weight:bold">def</span> <span style="color:#010181">implements</span><span style="color:#000000">(</span>method<span style="color:#000000">):</span>
    <span style="color:#000000; font-weight:bold">def</span> <span style="color:#010181">wrapper</span><span style="color:#000000">(</span>func<span style="color:#000000">):</span>
        <span style="color:#000000; font-weight:bold">if</span> func<span style="color:#000000">.</span>__name__ <span style="color:#000000">!=</span> method<span style="color:#000000">.</span>__name__<span style="color:#000000">:</span>
            msg <span style="color:#000000">=</span> <span style="color:#bf0303">&quot;Wrong &#64;implements:</span> <span style="color:#0057ae">%r ex</span><span style="color:#bf0303">pected, but implementing</span> <span style="color:#0057ae">%r</span><span style="color:#bf0303">.&quot;</span>
            msg <span style="color:#000000">=</span> msg % <span style="color:#000000">(</span>func<span style="color:#000000">.</span>__name__<span style="color:#000000">,</span> method<span style="color:#000000">.</span>__name__<span style="color:#000000">)</span>
            <span style="color:#000000; font-weight:bold">raise</span> <span style="color:#000000; font-weight:bold">AssertionError</span><span style="color:#000000">(</span>msg<span style="color:#000000">)</span>

        <span style="color:#000000; font-weight:bold">if</span> func<span style="color:#000000">.</span>__doc__ <span style="color:#000000; font-weight:bold">is None</span><span style="color:#000000">:</span>
            func<span style="color:#000000">.</span>__doc__ <span style="color:#000000">=</span> method<span style="color:#000000">.</span>__doc__

        <span style="color:#000000; font-weight:bold">return</span> func

    <span style="color:#000000; font-weight:bold">return</span> wrapper</code></pre>
</div></div>
</div>
</div>
<div class="sect1">
<h2 id="_docstring_copy_with_decorators">28. Docstring copy with decorators</h2>
<div class="sectionbody">
<div class="admonitionblock">
<table><tr>
<td class="icon">
<img src="../asciidoc/images/icons/note.png" alt="Note">
</td>
<td class="content">Heavily borrowed from <a href="https://github.com/matplotlib/matplotlib">matplotlib</a>. <a href="https://github.com/matplotlib/matplotlib/blob/master/lib/matplotlib/docstring.py">docstring.py</a></td>
</tr></table>
</div>
<div class="paragraph"><p>This decorator can be used to copy the docstring from function to another. This is usefule in cases where a wrapper function
calls an internal function which does mostly the same and has the same interface.</p></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<img src="../asciidoc/images/icons/important.png" alt="Important">
</td>
<td class="content">Instead of writing your own <span class="monospaced">docstring.py</span> please consider to use that provided by matplotlib: <span class="monospaced">from matplotlib import docstring</span></td>
</tr></table>
</div>
<div class="listingblock">
<div class="title">docstring.py</div>
<div class="content">
<pre><code><span style="color:#000000; font-weight:bold">import</span> re

<span style="color:#838183; font-style:italic"># A regular expression used to determine the amount of space to</span>
<span style="color:#838183; font-style:italic"># remove.  It looks for the first sequence of spaces immediately</span>
<span style="color:#838183; font-style:italic"># following the first newline, or at the beginning of the string.</span>
_find_dedent_regex <span style="color:#000000">=</span> re<span style="color:#000000">.</span><span style="color:#0057ae">compile</span><span style="color:#000000">(</span><span style="color:#bf0303">&quot;(?:(?:</span><span style="color:#ff00ff">\n\r</span><span style="color:#bf0303">?)|^)( *)\S&quot;</span><span style="color:#000000">)</span>
<span style="color:#838183; font-style:italic"># A cache to hold the regexs that actually remove the indent.</span>
_dedent_regex <span style="color:#000000">= {}</span>

<span style="color:#000000; font-weight:bold">def</span> <span style="color:#010181">_dedent</span><span style="color:#000000">(</span>s<span style="color:#000000">):</span>
    <span style="color:#bf0303">&quot;&quot;&quot;</span>
<span style="color:#bf0303">    Remove excess indentation from docstring *s*.</span>
<span style="color:#bf0303"></span>
<span style="color:#bf0303">    Discards any leading blank lines, then removes up to n whitespace</span>
<span style="color:#bf0303">    characters from each line, where n is the number of leading</span>
<span style="color:#bf0303">    whitespace characters in the first line. It differs from</span>
<span style="color:#bf0303">    textwrap.dedent in its deletion of leading blank lines and its use</span>
<span style="color:#bf0303">    of the first non-blank line to determine the indentation.</span>
<span style="color:#bf0303"></span>
<span style="color:#bf0303">    It is also faster in most cases.</span>
<span style="color:#bf0303">    &quot;&quot;&quot;</span>
    <span style="color:#838183; font-style:italic"># This implementation has a somewhat obtuse use of regular</span>
    <span style="color:#838183; font-style:italic"># expressions.  However, this function accounted for almost 30% of</span>
    <span style="color:#838183; font-style:italic"># matplotlib startup time, so it is worthy of optimization at all</span>
    <span style="color:#838183; font-style:italic"># costs.</span>

    <span style="color:#000000; font-weight:bold">if not</span> s<span style="color:#000000">:</span>      <span style="color:#838183; font-style:italic"># includes case of s is None</span>
        <span style="color:#000000; font-weight:bold">return</span> <span style="color:#bf0303">''</span>

    match <span style="color:#000000">=</span> _find_dedent_regex<span style="color:#000000">.</span><span style="color:#010181">match</span><span style="color:#000000">(</span>s<span style="color:#000000">)</span>
    <span style="color:#000000; font-weight:bold">if</span> match <span style="color:#000000; font-weight:bold">is None</span><span style="color:#000000">:</span>
        <span style="color:#000000; font-weight:bold">return</span> s

    <span style="color:#838183; font-style:italic"># This is the number of spaces to remove from the left-hand side.</span>
    nshift <span style="color:#000000">=</span> match<span style="color:#000000">.</span><span style="color:#010181">end</span><span style="color:#000000">(</span><span style="color:#b07e00">1</span><span style="color:#000000">) -</span> match<span style="color:#000000">.</span><span style="color:#010181">start</span><span style="color:#000000">(</span><span style="color:#b07e00">1</span><span style="color:#000000">)</span>
    <span style="color:#000000; font-weight:bold">if</span> nshift <span style="color:#000000">==</span> <span style="color:#b07e00">0</span><span style="color:#000000">:</span>
        <span style="color:#000000; font-weight:bold">return</span> s

    <span style="color:#838183; font-style:italic"># Get a regex that will remove *up to* nshift spaces from the</span>
    <span style="color:#838183; font-style:italic"># beginning of each line.  If it isn't in the cache, generate it.</span>
    unindent <span style="color:#000000">=</span> _dedent_regex<span style="color:#000000">.</span><span style="color:#010181">get</span><span style="color:#000000">(</span>nshift<span style="color:#000000">,</span> <span style="color:#000000; font-weight:bold">None</span><span style="color:#000000">)</span>
    <span style="color:#000000; font-weight:bold">if</span> unindent <span style="color:#000000; font-weight:bold">is None</span><span style="color:#000000">:</span>
        unindent <span style="color:#000000">=</span> re<span style="color:#000000">.</span><span style="color:#0057ae">compile</span><span style="color:#000000">(</span><span style="color:#bf0303">&quot;</span><span style="color:#ff00ff">\n\r</span><span style="color:#bf0303">? {0,</span><span style="color:#0057ae">%d</span><span style="color:#bf0303">}&quot;</span> % nshift<span style="color:#000000">)</span>
        _dedent_regex<span style="color:#000000">[</span>nshift<span style="color:#000000">] =</span> unindent

    result <span style="color:#000000">=</span> unindent<span style="color:#000000">.</span><span style="color:#010181">sub</span><span style="color:#000000">(</span><span style="color:#bf0303">&quot;</span><span style="color:#ff00ff">\n</span><span style="color:#bf0303">&quot;</span><span style="color:#000000">,</span> s<span style="color:#000000">).</span><span style="color:#010181">strip</span><span style="color:#000000">()</span>
    <span style="color:#000000; font-weight:bold">return</span> result

<span style="color:#000000; font-weight:bold">def</span> <span style="color:#010181">dedent</span><span style="color:#000000">(</span>func<span style="color:#000000">):</span>
    <span style="color:#bf0303">&quot;Dedent a docstring (if present)&quot;</span>
    func<span style="color:#000000">.</span>__doc__ <span style="color:#000000">=</span> func<span style="color:#000000">.</span>__doc__ <span style="color:#000000; font-weight:bold">and</span> <span style="color:#010181">_dedent</span><span style="color:#000000">(</span>func<span style="color:#000000">.</span>__doc__<span style="color:#000000">)</span>
    <span style="color:#000000; font-weight:bold">return</span> func

<span style="color:#000000; font-weight:bold">def</span> <span style="color:#010181">copy_dedent</span><span style="color:#000000">(</span>source<span style="color:#000000">):</span>
    <span style="color:#bf0303">&quot;&quot;&quot;A decorator that will copy the docstring from the source and</span>
<span style="color:#bf0303">    then dedent it&quot;&quot;&quot;</span>
    <span style="color:#838183; font-style:italic"># note the following is ugly because &quot;Python is not a functional</span>
    <span style="color:#838183; font-style:italic"># language&quot; - GVR. Perhaps one day, functools.compose will exist.</span>
    <span style="color:#838183; font-style:italic">#  or perhaps not.</span>
    <span style="color:#838183; font-style:italic">#  http://mail.python.org/pipermail/patches/2007-February/021687.html</span>
    <span style="color:#000000; font-weight:bold">return lambda</span> target<span style="color:#000000">:</span> <span style="color:#010181">dedent</span><span style="color:#000000">(</span><span style="color:#010181">copy</span><span style="color:#000000">(</span>source<span style="color:#000000">)(</span>target<span style="color:#000000">))</span>

<span style="color:#000000; font-weight:bold">def</span> <span style="color:#010181">copy</span><span style="color:#000000">(</span>source<span style="color:#000000">):</span>
    <span style="color:#bf0303">&quot;Copy a docstring from another source function (if present)&quot;</span>
    <span style="color:#000000; font-weight:bold">def</span> <span style="color:#010181">do_copy</span><span style="color:#000000">(</span>target<span style="color:#000000">):</span>
        <span style="color:#000000; font-weight:bold">if</span> source<span style="color:#000000">.</span>__doc__<span style="color:#000000">:</span>
            target<span style="color:#000000">.</span>__doc__ <span style="color:#000000">=</span> source<span style="color:#000000">.</span>__doc__
        <span style="color:#000000; font-weight:bold">return</span> target
    <span style="color:#000000; font-weight:bold">return</span> do_copy

<span style="color:#000000; font-weight:bold">class</span> <span style="color:#010181">Appender</span><span style="color:#000000">(</span><span style="color:#0057ae">object</span><span style="color:#000000">):</span>
    <span style="color:#bf0303">&quot;&quot;&quot;</span>
<span style="color:#bf0303">    A function decorator that will append an addendum to the docstring</span>
<span style="color:#bf0303">    of the target function.</span>
<span style="color:#bf0303"></span>
<span style="color:#bf0303">    This decorator should be robust even if func.__doc__ is None</span>
<span style="color:#bf0303">    (for example, if -OO was passed to the interpreter).</span>
<span style="color:#bf0303"></span>
<span style="color:#bf0303">    Usage: construct a docstring.Appender with a string to be joined to</span>
<span style="color:#bf0303">    the original docstring. An optional 'join' parameter may be supplied</span>
<span style="color:#bf0303">    which will be used to join the docstring and addendum. e.g.</span>
<span style="color:#bf0303"></span>
<span style="color:#bf0303">    add_copyright = Appender(&quot;Copyright (c) 2009&quot;, join='</span><span style="color:#ff00ff">\n</span><span style="color:#bf0303">')</span>
<span style="color:#bf0303"></span>
<span style="color:#bf0303">    &#64;add_copyright</span>
<span style="color:#bf0303">    def my_dog(has='fleas'):</span>
<span style="color:#bf0303">        &quot;This docstring will have a copyright below&quot;</span>
<span style="color:#bf0303">        pass</span>
<span style="color:#bf0303">    &quot;&quot;&quot;</span>
    <span style="color:#000000; font-weight:bold">def</span> <span style="color:#010181">__init__</span><span style="color:#000000">(</span>self<span style="color:#000000">,</span> addendum<span style="color:#000000">,</span> join<span style="color:#000000">=</span><span style="color:#bf0303">''</span><span style="color:#000000">):</span>
        self<span style="color:#000000">.</span>addendum <span style="color:#000000">=</span> addendum
        self<span style="color:#000000">.</span>join <span style="color:#000000">=</span> join

    <span style="color:#000000; font-weight:bold">def</span> <span style="color:#010181">__call__</span><span style="color:#000000">(</span>self<span style="color:#000000">,</span> func<span style="color:#000000">):</span>
        docitems <span style="color:#000000">= [</span>func<span style="color:#000000">.</span>__doc__<span style="color:#000000">,</span> self<span style="color:#000000">.</span>addendum<span style="color:#000000">]</span>
        func<span style="color:#000000">.</span>__doc__ <span style="color:#000000">=</span> func<span style="color:#000000">.</span>__doc__ <span style="color:#000000; font-weight:bold">and</span> self<span style="color:#000000">.</span>join<span style="color:#000000">.</span><span style="color:#010181">join</span><span style="color:#000000">(</span>docitems<span style="color:#000000">)</span>
        <span style="color:#000000; font-weight:bold">return</span> func</code></pre>
</div></div>
</div>
</div>
<div class="sect1">
<h2 id="_creating_intermediate_folders">29. Creating (intermediate) Folders</h2>
<div class="sectionbody">
<div class="paragraph"><p>Normally you can create folders by calling <a href="https://docs.python.org/2/library/os.html?highlight=mkdir#os.mkdir"><span class="monospaced">os.mkdir(path[, mode])</span></a>.
However, if the folder already exist or intermediate folders are missing, this function throws an exception. If you want to have the same behavior as <span class="monospaced">mkdir -p &lt;folder&gt;</span> which ignores if
the &lt;folder&gt; already exists. You write following code:</p></div>
<div class="listingblock">
<div class="content">
<pre><code><span style="color:#000000; font-weight:bold">import</span> os
<span style="color:#000000; font-weight:bold">import</span> errno

<span style="color:#000000; font-weight:bold">def</span> <span style="color:#010181">mkdirs_p</span><span style="color:#000000">(</span>path<span style="color:#000000">):</span>
    <span style="color:#000000; font-weight:bold">try</span><span style="color:#000000">:</span>
        os<span style="color:#000000">.</span><span style="color:#010181">makedirs</span><span style="color:#000000">(</span>path<span style="color:#000000">)</span>
    <span style="color:#000000; font-weight:bold">except</span> <span style="color:#000000; font-weight:bold">OSError</span> <span style="color:#000000; font-weight:bold">as</span> exception<span style="color:#000000">:</span>
        <span style="color:#000000; font-weight:bold">if</span> exception<span style="color:#000000">.</span>errno <span style="color:#000000">!=</span> errno<span style="color:#000000">.</span>EEXIST<span style="color:#000000">:</span>
            <span style="color:#000000; font-weight:bold">raise</span></code></pre>
</div></div>
<div class="paragraph"><p>Since Python 3.2 it is possible to use <a href="https://docs.python.org/3/library/os.html?highlight=makedirs#os.makedirs"><span class="monospaced">os.makedirs(&lt;folder&gt;, mode=0o777, exist_ok=True)</span></a> for having the same behavior.</p></div>
</div>
</div>
<div class="sect1">
<h2 id="_upgrade_all_python_packages_via_pip">30. Upgrade all python packages via pip</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="title">Script test on Ubuntu 13.10</div>
<div class="content">
<pre><code><span style="color:#838183; font-style:italic">#!/usr/bin/env python</span>
<span style="color:#000000; font-weight:bold">import</span> pip
<span style="color:#000000; font-weight:bold">from</span> subprocess <span style="color:#000000; font-weight:bold">import</span> call

<span style="color:#000000; font-weight:bold">for</span> dist <span style="color:#000000; font-weight:bold">in</span> pip<span style="color:#000000">.</span><span style="color:#010181">get_installed_distributions</span><span style="color:#000000">():</span>
    <span style="color:#010181">call</span><span style="color:#000000">(</span><span style="color:#bf0303">&quot;sudo pip install --upgrade &quot;</span> <span style="color:#000000">+</span> dist<span style="color:#000000">.</span>project_name<span style="color:#000000">,</span> shell<span style="color:#000000">=</span><span style="color:#000000; font-weight:bold">True</span><span style="color:#000000">)</span></code></pre>
</div></div>
</div>
</div>
<div class="sect1">
<h2 id="_make_script_pipeable">31. Make Script "pipeable"</h2>
<div class="sectionbody">
<div class="paragraph"><p>This script demonstrates how to make python scripts pipeable
see:</p></div>
<div class="ulist"><ul>
<li>
<p>
<a href="http://stackoverflow.com/a/4430047/1959528">http://stackoverflow.com/a/4430047/1959528</a>
</p>
</li>
<li>
<p>
<a href="http://stackoverflow.com/q/1450393/1959528">http://stackoverflow.com/q/1450393/1959528</a>
</p>
</li>
</ul></div>
<div class="paragraph"><p>Notice however, the scripts blocks until it gets a EOF char <span class="monospaced">ctrl+d</span> on unix systems.</p></div>
<div class="listingblock">
<div class="title">echo.py: Example which pipes all lines from stdin to stdout and stderr</div>
<div class="content">
<pre><code><span style="color:#838183; font-style:italic">#!/usr/bin/env python</span>
<span style="color:#000000; font-weight:bold">if</span> __name__ <span style="color:#000000">==</span> <span style="color:#bf0303">&quot;__main__&quot;</span><span style="color:#000000">:</span>
    <span style="color:#000000; font-weight:bold">import</span> sys
    <span style="color:#000000; font-weight:bold">for</span> line <span style="color:#000000; font-weight:bold">in</span> sys<span style="color:#000000">.</span>stdin<span style="color:#000000">:</span>
        sys<span style="color:#000000">.</span>stderr<span style="color:#000000">.</span><span style="color:#010181">write</span><span style="color:#000000">(</span><span style="color:#bf0303">&quot;DEBUG: got line: &quot;</span> <span style="color:#000000">+</span> line<span style="color:#000000">)</span>
        sys<span style="color:#000000">.</span>stdout<span style="color:#000000">.</span><span style="color:#010181">write</span><span style="color:#000000">(</span>line<span style="color:#000000">)</span></code></pre>
</div></div>
</div>
</div>
</div>
<div id="footnotes"><hr></div>
<div id="footer">
<div id="footer-text">
Version 0.0.1 'http://semver.org/[(semver)]'<br>
Last updated
 2017-04-06 22:20:26 CEST
</div>
</div>
</body>
</html>
